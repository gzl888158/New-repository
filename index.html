<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>欧易合约AI辅助工具 + 自动交易机器人</title>
    <script src="https://cdn.bootcdn.net/ajax/libs/echarts/5.4.3/echarts.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background: #121212; 
            color: #fff; 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            min-height: 100vh;
            padding-top: 50px;
        }
        h1 { text-align: center; margin-bottom: 20px; color: #e5e5e5; font-size: 18px; }
        .container { max-width: 1200px; margin: 0 auto; }
        /* 机器人开关面板 */
        .bot-switch-panel {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            text-align: center;
            border-left: 4px solid #ff4d4f;
        }
        .bot-switch-btn {
            padding: 10px 30px;
            font-size: 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 0 10px;
        }
        .bot-off { background: #ff4d4f; color: #fff; }
        .bot-on { background: #52c41a; color: #fff; }
        .bot-status-text { font-size: 14px; margin-top: 10px; color: #999; }
        /* 交易参数配置面板 */
        .bot-config-panel {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }
        .bot-config-panel h2 { font-size: 16px; margin-bottom: 10px; color: #fff; }
        .config-group { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 10px; }
        .config-group input, .config-group select {
            padding: 8px;
            background: #2a2a2a;
            border: 1px solid #444;
            border-radius: 4px;
            color: #fff;
            flex: 1;
            min-width: 100px;
        }
        /* 原有面板样式保留 */
        .ai-panel, .market-panel, .alert-panel, .position-panel, .detail-panel {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }
        .ai-panel { border-left: 4px solid #1890ff; }
        .ai-panel h2, .market-panel h2, .alert-panel h2, .position-panel h2, .detail-panel h2 {
            font-size: 16px; margin-bottom: 10px; color: #fff;
        }
        .ai-signal {
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            font-weight: bold;
            text-align: center;
        }
        .signal-buy { background: #52c41a; color: #fff; }
        .signal-sell { background: #ff4d4f; color: #fff; }
        .signal-hold { background: #faad14; color: #fff; }
        .ticker-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; }
        .ticker-card {
            background: #2a2a2a;
            padding: 10px;
            border-radius: 4px;
            text-align: center;
            cursor: pointer;
            transition: background 0.2s;
        }
        .ticker-card:hover { background: #3a3a3a; }
        .input-group { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 10px; }
        .input-group input, .input-group select {
            padding: 8px;
            background: #2a2a2a;
            border: 1px solid #444;
            border-radius: 4px;
            color: #fff;
            flex: 1;
            min-width: 120px;
        }
        .input-group button {
            padding: 8px 15px;
            background: #52c41a;
            border: none;
            border-radius: 4px;
            color: #fff;
            cursor: pointer;
        }
        .profit-table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        .profit-table th, .profit-table td {
            padding: 8px;
            border: 1px solid #444;
            text-align: center;
            font-size: 12px;
        }
        .profit-green { color: #52c41a; font-weight: bold; }
        .profit-red { color: #ff4d4f; font-weight: bold; }
        .detail-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; font-size: 12px; }
        .detail-item { background: #2a2a2a; padding: 8px; border-radius: 4px; text-align: center; }
        .chart-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 20px; }
        .chart-box { height: 300px; border: 1px solid #333; border-radius: 8px; padding: 10px; background: #1a1a1a; }
        .status-bar { position: fixed; top: 0; left: 0; width: 100%; padding: 10px; text-align: center; font-size: 14px; z-index: 999; }
        .status-success { background: #52c41a; color: #fff; }
        .status-error { background: #ff4d4f; color: #fff; }
        .shortcut { position: fixed; bottom: 15px; left: 50%; transform: translateX(-50%); color: #999; font-size: 12px; text-align: center; }
        @media (max-width: 768px) {
            .ticker-grid, .detail-grid { grid-template-columns: repeat(2, 1fr); }
            .chart-grid { grid-template-columns: 1fr; }
            .chart-box { height: 250px; }
        }
    </style>
</head>
<body>
    <div class="status-bar" id="statusBar">正在初始化AI交易机器人...</div>
    <div class="container">
        <h1>欧易合约AI辅助工具 + 自动交易机器人</h1>

        <!-- 机器人开关面板 -->
        <div class="bot-switch-panel">
            <button id="botSwitchBtn" class="bot-switch-btn bot-off" onclick="toggleTradeBot()">启动交易机器人</button>
            <p class="bot-status-text" id="botStatusText">当前状态：<span style="color:#ff4d4f;">已关闭</span> | 未执行任何交易</p>
        </div>

        <!-- 交易参数配置面板 -->
        <div class="bot-config-panel">
            <h2>交易机器人参数配置</h2>
            <div class="config-group">
                <select id="botInstId">
                    <option value="BTC-USDT-SWAP">BTC-USDT 永续合约</option>
                    <option value="ETH-USDT-SWAP">ETH-USDT 永续合约</option>
                    <option value="SOL-USDT-SWAP">SOL-USDT 永续合约</option>
                </select>
                <input type="number" id="marginAmt" placeholder="开仓保证金(USDT)" value="10" step="0.1">
                <input type="number" id="leverage" placeholder="杠杆倍数" value="10" step="1">
            </div>
            <div class="config-group">
                <input type="number" id="takeProfitRatio" placeholder="止盈比例(%)" value="1" step="0.1">
                <input type="number" id="stopLossRatio" placeholder="止损比例(%)" value="0.5" step="0.1">
                <input type="text" id="apiKey" placeholder="欧易API Key（只读+交易）">
                <input type="text" id="apiSecret" placeholder="欧易API Secret">
                <input type="text" id="apiPass" placeholder="欧易API Passphrase">
            </div>
            <p style="font-size: 12px; color: #ff4d4f;">⚠️ 注意：API需开启【交易权限】，请保管好密钥，切勿泄露！</p>
        </div>

        <!-- 原有AI分析、行情、预警、持仓、详情、图表面板 -->
        <div class="ai-panel">
            <h2>AI行情分析 & 策略运行状态</h2>
            <div id="aiAnalysis">
                <p>正在拉取最新AI分析结果...</p>
            </div>
            <div id="aiSignal" class="ai-signal signal-hold">等待AI分析数据...</div>
            <div id="botStatus" style="margin-top: 10px; font-size: 12px; color: #999;">
                策略运行状态：未获取到
            </div>
        </div>

        <div class="market-panel">
            <h2>主流币实时行情</h2>
            <div class="ticker-grid">
                <div id="ticker-BTC" class="ticker-card"></div>
                <div id="ticker-ETH" class="ticker-card"></div>
                <div id="ticker-SOL" class="ticker-card"></div>
                <div id="ticker-BNB" class="ticker-card"></div>
            </div>
        </div>

        <div class="alert-panel">
            <h2>价格预警设置</h2>
            <div class="input-group">
                <select id="alertInstId">
                    <option value="BTC-USDT">BTC-USDT</option>
                    <option value="ETH-USDT">ETH-USDT</option>
                    <option value="SOL-USDT">SOL-USDT</option>
                </select>
                <input type="number" id="alertPrice" placeholder="预警价格" step="0.01">
                <select id="alertType">
                    <option value="up">价格上涨至</option>
                    <option value="down">价格下跌至</option>
                </select>
                <button onclick="addPriceAlert()" style="background: #faad14;">添加预警</button>
                <button onclick="clearPriceAlert()" style="background: #ff4d4f;">清空预警</button>
            </div>
            <div id="alertList" style="margin-top: 10px; font-size: 12px; color: #ccc;">
                暂无预警设置
            </div>
        </div>

        <div class="position-panel">
            <h2>持仓信息录入 & 盈亏计算</h2>
            <div class="input-group">
                <select id="instIdSelect">
                    <option value="BTC-USDT">BTC-USDT</option>
                    <option value="ETH-USDT">ETH-USDT</option>
                    <option value="SOL-USDT">SOL-USDT</option>
                </select>
                <select id="directionSelect">
                    <option value="long">做多（多仓）</option>
                    <option value="short">做空（空仓）</option>
                </select>
                <input type="number" id="entryPrice" placeholder="开仓价格" step="0.01">
                <input type="number" id="positionAmt" placeholder="持仓数量" step="0.001">
                <button onclick="calculateProfit()">计算盈亏</button>
                <button onclick="savePositionRecord()" style="background: #1890ff;">保存记录</button>
            </div>
            <div class="record-group">
                <span>历史持仓记录：</span>
                <select id="recordSelect" onchange="loadPositionRecord()">
                    <option value="">请选择保存的记录</option>
                </select>
                <button onclick="deletePositionRecord()">删除记录</button>
            </div>
            <table class="profit-table">
                <thead>
                    <tr>
                        <th>币种</th>
                        <th>方向</th>
                        <th>开仓价</th>
                        <th>当前价</th>
                        <th>持仓量</th>
                        <th>浮动盈亏</th>
                        <th>盈亏比例</th>
                    </tr>
                </thead>
                <tbody id="profitTableBody">
                    <tr><td colspan="7">请录入持仓信息并点击计算</td></tr>
                </tbody>
            </table>
        </div>

        <div class="detail-panel">
            <h2 id="detailTitle">BTC-USDT 详情数据</h2>
            <div class="detail-grid">
                <div class="detail-item">
                    <p style="color: #999; font-size: 10px;">24h最高</p>
                    <p id="detail-high">--</p>
                </div>
                <div class="detail-item">
                    <p style="color: #999; font-size: 10px;">24h最低</p>
                    <p id="detail-low">--</p>
                </div>
                <div class="detail-item">
                    <p style="color: #999; font-size: 10px;">24h成交量</p>
                    <p id="detail-vol">--</p>
                </div>
                <div class="detail-item">
                    <p style="color: #999; font-size: 10px;">24h涨跌幅</p>
                    <p id="detail-change">--</p>
                </div>
            </div>
        </div>

        <div class="chart-grid">
            <div class="chart-box" id="btc-chart">15m K线图</div>
            <div class="chart-box" id="depth-chart">深度图（前5档）</div>
        </div>
    </div>
    <div class="shortcut">AI分析每30分钟更新 | 行情每10秒刷新 | F1切换币种 | F2查看帮助 | 机器人需配置API</div>

    <script>
        // ========== 全局配置 ==========
        const API_BASE_URL = "https://www.okx.com/api/v5/market";
        const TRADE_API_URL = "https://www.okx.com/api/v5/trade";
        const ACCOUNT_API_URL = "https://www.okx.com/api/v5/account";
        const GITHUB_REPO_URL = "https://gzl888158.github.io";
        const REFRESH_INTERVAL = 10000;
        const AI_REFRESH_INTERVAL = 1800000;

        // 全局状态
        let btcChart, depthChart;
        let currentInstId = "BTC-USDT";
        let currentPrice = 0;
        let lastAISignal = "hold";
        let isTradeBotRunning = false; // 机器人开关状态
        let currentPosition = null; // 当前持仓

        // 存储键名
        const RECORD_KEY = "okx_position_records";
        const ALERT_KEY = "okx_price_alerts";
        const BOT_CONFIG_KEY = "okx_bot_config";

        // 主流币列表
        const MAJOR_COINS = [
            { symbol: "BTC", instId: "BTC-USDT", swapId: "BTC-USDT-SWAP" },
            { symbol: "ETH", instId: "ETH-USDT", swapId: "ETH-USDT-SWAP" },
            { symbol: "SOL", instId: "SOL-USDT", swapId: "SOL-USDT-SWAP" },
            { symbol: "BNB", instId: "BNB-USDT", swapId: "BNB-USDT-SWAP" }
        ];

        // ========== 页面初始化 ==========
        $(document).ready(() => {
            requestNotificationPermission();
            initCharts();
            loadAllPositionRecords();
            loadPriceAlerts();
            loadBotConfig(); // 加载机器人配置
            fetchAllData();
            fetchAIAnalysis();
            fetchBotStatus();
            fetchMajorTickers();
            // 定时任务
            setInterval(fetchAllData, REFRESH_INTERVAL);
            setInterval(fetchAIAnalysis, AI_REFRESH_INTERVAL);
            setInterval(fetchBotStatus, 60000);
            setInterval(fetchMajorTickers, REFRESH_INTERVAL);
            setInterval(checkPriceAlerts, 5000);
            setInterval(checkPositionProfit, 10000); // 每10秒检查持仓盈亏
            bindEvents();
        });

        // ========== 交易机器人核心逻辑 ==========
        // 机器人开关
        function toggleTradeBot() {
            if (!isTradeBotRunning) {
                // 启动前校验
                const apiKey = $("#apiKey").val().trim();
                const apiSecret = $("#apiSecret").val().trim();
                const apiPass = $("#apiPass").val().trim();
                if (!apiKey || !apiSecret || !apiPass) {
                    alert("请填写完整的欧易API信息！");
                    return;
                }
                isTradeBotRunning = true;
                $("#botSwitchBtn").text("停止交易机器人").removeClass("bot-off").addClass("bot-on");
                $("#botStatusText").html("当前状态：<span style='color:#52c41a;'>运行中</span> | 等待AI信号触发交易");
                saveBotConfig(); // 保存配置
                updateStatus("交易机器人已启动，等待AI信号...", true);
            } else {
                // 停止机器人
                isTradeBotRunning = false;
                $("#botSwitchBtn").text("启动交易机器人").removeClass("bot-on").addClass("bot-off");
                $("#botStatusText").html("当前状态：<span style='color:#ff4d4f;'>已关闭</span> | 未执行任何交易");
                updateStatus("交易机器人已停止", true);
            }
        }

        // AI信号触发交易
        function triggerTradeBySignal(signal, instId) {
            if (!isTradeBotRunning) return;
            // 只交易选中的合约
            const targetInstId = $("#botInstId").val();
            if (instId !== targetInstId) return;

            // 1. 先查询当前持仓，避免重复开仓
            checkCurrentPosition().then(pos => {
                currentPosition = pos;
                // 买入信号：无持仓时开多仓
                if (signal === "buy" && !currentPosition) {
                    openPosition("long", targetInstId);
                }
                // 卖出信号：无持仓时开空仓
                else if (signal === "sell" && !currentPosition) {
                    openPosition("short", targetInstId);
                }
                // 有持仓时，信号反转则平仓
                else if (currentPosition) {
                    if ((signal === "buy" && currentPosition.posSide === "short") || 
                        (signal === "sell" && currentPosition.posSide === "long")) {
                        closePosition(currentPosition);
                    }
                }
            });
        }

        // 开仓
        function openPosition(posSide, instId) {
            const marginAmt = parseFloat($("#marginAmt").val());
            const leverage = parseFloat($("#leverage").val());
            const takeProfitRatio = parseFloat($("#takeProfitRatio").val()) / 100;
            const stopLossRatio = parseFloat($("#stopLossRatio").val()) / 100;

            // 计算止盈止损价格
            let tpPrice, slPrice;
            if (posSide === "long") {
                tpPrice = (currentPrice * (1 + takeProfitRatio)).toFixed(2);
                slPrice = (currentPrice * (1 - stopLossRatio)).toFixed(2);
            } else {
                tpPrice = (currentPrice * (1 - takeProfitRatio)).toFixed(2);
                slPrice = (currentPrice * (1 + stopLossRatio)).toFixed(2);
            }

            // 构建订单参数
            const orderParams = {
                instId: instId,
                tdMode: "isolated", // 逐仓
                side: posSide === "long" ? "buy" : "sell",
                posSide: posSide,
                ordType: "market", // 市价单
                sz: calculateSize(marginAmt, leverage), // 计算下单数量
                tgtCcy: "base_ccy",
                tpTriggerPx: tpPrice,
                tpOrdPx: tpPrice,
                slTriggerPx: slPrice,
                slOrdPx: slPrice
            };

            // 发送下单请求
            sendTradeRequest("/order", "POST", orderParams).then(res => {
                if (res.code === "0") {
                    updateStatus(`✅ 成功${posSide === "long" ? "开多" : "开空"} ${instId}，订单号：${res.data[0].ordId}`, true);
                    savePositionRecordByTrade(posSide, instId, currentPrice, orderParams.sz);
                } else {
                    updateStatus(`❌ 下单失败：${res.msg}`, false);
                }
            }).catch(err => {
                updateStatus(`❌ 下单异常：${err}`, false);
            });
        }

        // 平仓
        function closePosition(pos) {
            const side = pos.posSide === "long" ? "sell" : "buy";
            const orderParams = {
                instId: pos.instId,
                tdMode: "isolated",
                side: side,
                posSide: pos.posSide,
                ordType: "market",
                sz: pos.pos
            };

            sendTradeRequest("/order", "POST", orderParams).then(res => {
                if (res.code === "0") {
                    updateStatus(`✅ 成功${pos.posSide === "long" ? "平多" : "平空"} ${pos.instId}，订单号：${res.data[0].ordId}`, true);
                    currentPosition = null;
                } else {
                    updateStatus(`❌ 平仓失败：${res.msg}`, false);
                }
            }).catch(err => {
                updateStatus(`❌ 平仓异常：${err}`, false);
            });
        }

        // 检查持仓盈亏，触发自动止盈止损
        function checkPositionProfit() {
            if (!currentPosition || !isTradeBotRunning) return;
            checkCurrentPosition().then(pos => {
                if (!pos) {
                    currentPosition = null;
                    return;
                }
                const profitRatio = (parseFloat(pos.uly) - parseFloat(pos.avgPx)) / parseFloat(pos.avgPx) * 100;
                const takeProfitRatio = parseFloat($("#takeProfitRatio").val());
                const stopLossRatio = parseFloat($("#stopLossRatio").val());

                // 多仓止盈止损
                if (pos.posSide === "long") {
                    if (profitRatio >= takeProfitRatio || profitRatio <= -stopLossRatio) {
                        closePosition(pos);
                    }
                }
                // 空仓止盈止损
                else {
                    if (profitRatio <= -takeProfitRatio || profitRatio >= stopLossRatio) {
                        closePosition(pos);
                    }
                }
            });
        }

        // ========== 欧易API请求工具函数 ==========
        // 生成API签名（HMAC SHA256）
        function generateSign(timestamp, method, requestPath, body) {
            const secret = $("#apiSecret").val().trim();
            const preHash = timestamp + method + requestPath + (body ? JSON.stringify(body) : "");
            return CryptoJS.HmacSHA256(preHash, secret).toString(CryptoJS.enc.Base64);
        }

        // 发送交易请求
        function sendTradeRequest(path, method, data) {
            const apiKey = $("#apiKey").val().trim();
            const apiPass = $("#apiPass").val().trim();
            const timestamp = new Date().toISOString();
            const sign = generateSign(timestamp, method, path, data);

            return new Promise((resolve, reject) => {
                $.ajax({
                    url: TRADE_API_URL + path,
                    method: method,
                    data: data ? JSON.stringify(data) : "",
                    headers: {
                        "OK-ACCESS-KEY": apiKey,
                        "OK-ACCESS-SIGN": sign,
                        "OK-ACCESS-TIMESTAMP": timestamp,
                        "OK-ACCESS-PASSPHRASE": apiPass,
                        "Content-Type": "application/json"
                    },
                    success: res => resolve(res),
                    error: err => reject(err.responseText)
                });
            });
        }

        // 查询当前持仓
        function checkCurrentPosition() {
            const instId = $("#botInstId").val();
            return new Promise((resolve, reject) => {
                $.ajax({
                    url: ACCOUNT_API_URL + "/positions?instType=SWAP&instId=" + instId,
                    method: "GET",
                    headers: getAuthHeaders("/positions?instType=SWAP&instId=" + instId, "GET"),
                    success: res => {
                        if (res.code === "0" && res.data.length > 0 && parseFloat(res.data[0].pos) > 0) {
                            resolve(res.data[0]);
                        } else {
                            resolve(null);
                        }
                    },
                    error: err => reject(err)
                });
            });
        }

        // 获取鉴权头
        function getAuthHeaders(requestPath, method) {
            const apiKey = $("#apiKey").val().trim();
            const apiPass = $("#apiPass").val().trim();
            const timestamp = new Date().toISOString();
            const sign = generateSign(timestamp, method, requestPath);
            return {
                "OK-ACCESS-KEY": apiKey,
                "OK-ACCESS-SIGN": sign,
                "OK-ACCESS-TIMESTAMP": timestamp,
                "OK-ACCESS-PASSPHRASE": apiPass
            };
        }

        // 计算下单数量
        function calculateSize(marginAmt, leverage) {
            return (marginAmt * leverage / currentPrice).toFixed(4);
        }

        // ========== 原有功能函数（省略，与之前一致） ==========
        function requestNotificationPermission() { if ("Notification" in window && Notification.permission !== "granted") { Notification.requestPermission(); } }
        function initCharts() { /* 原有图表初始化代码 */ }
        function bindEvents() { /* 原有事件绑定代码 */ }
        function updateStatus(text, isSuccess) { /* 原有状态更新代码 */ }
        function fetchAllData() { /* 原有行情拉取代码 */ }
        function fetchAIAnalysis() { 
            $.get(`${GITHUB_REPO_URL}/multi_coin_ai_log.json`, (data) => {
                renderAIAnalysis(data);
                // 遍历币种信号，触发交易
                data.coins.forEach(coin => {
                    triggerTradeBySignal(coin.signal, coin.instId);
                });
            }).fail(() => {
                const mock = { updateTime: new Date().toLocaleString(), coins: [{instId: "BTC-USDT-SWAP", signal: "hold", analysis: "模拟数据"}] };
                renderAIAnalysis(mock);
            });
        }
        function renderAIAnalysis(data) { /* 原有AI分析渲染代码，新增多币种遍历 */ }
        function fetchMajorTickers() { /* 原有主流币行情拉取代码 */ }
        function calculateProfit() { /* 原有盈亏计算代码 */ }
        function savePositionRecord() { /* 原有持仓记录保存代码 */ }
        function loadAllPositionRecords() { /* 原有持仓记录加载代码 */ }
        function addPriceAlert() { /* 原有价格预警添加代码 */ }
        function checkPriceAlerts() { /* 原有价格预警检查代码 */ }
        // 新增：通过交易自动保存持仓记录
        function savePositionRecordByTrade(posSide, instId, entryPrice, amt) {
            const record = {
                id: new Date().getTime(),
                name: `${instId}-${posSide === "long" ? "多" : "空"}`,
                instId: instId.replace("-SWAP", ""),
                direction: posSide,
                entryPrice: entryPrice,
                positionAmt: amt,
                createTime: new Date().toLocaleString()
            };
            let records = JSON.parse(localStorage.getItem(RECORD_KEY) || "[]");
            records.push(record);
            localStorage.setItem(RECORD_KEY, JSON.stringify(records));
            loadAllPositionRecords();
        }
        // 保存/加载机器人配置
        function saveBotConfig() {
            const config = {
                apiKey: $("#apiKey").val(),
                apiSecret: $("#apiSecret").val(),
                apiPass: $("#apiPass").val(),
                instId: $("#botInstId").val(),
                marginAmt: $("#marginAmt").val(),
                leverage: $("#leverage").val(),
                tpRatio: $("#takeProfitRatio").val(),
                slRatio: $("#stopLossRatio").val()
            };
            localStorage.setItem(BOT_CONFIG_KEY, JSON.stringify(config));
        }
        function loadBotConfig() {
            const config = JSON.parse(localStorage.getItem(BOT_CONFIG_KEY) || "{}");
            if (config.apiKey) $("#apiKey").val(config.apiKey);
            if (config.apiSecret) $("#apiSecret").val(config.apiSecret);
            if (config.apiPass) $("#apiPass").val(config.apiPass);
            if (config.instId) $("#botInstId").val(config.instId);
            if (config.marginAmt) $("#marginAmt").val(config.marginAmt);
            if (config.leverage) $("#leverage").val(config.leverage);
            if (config.tpRatio) $("#takeProfitRatio").val(config.tpRatio);
            if (config.slRatio) $("#stopLossRatio").val(config.slRatio);
        }
    </script>
    <!-- 引入CryptoJS用于API签名 -->
    <script src="https://cdn.bootcdn.net/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
</body>
</html>