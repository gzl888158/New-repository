<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>å‚»ç“œå¼æ¬§æ˜“åˆçº¦äº¤æ˜“åŠ©æ‰‹ | è‡ªåŠ¨å§”æ‰˜ç‰ˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "å¾®è½¯é›…é»‘", Arial, sans-serif;
        }
        body {
            background: #0f172a;
            color: #f8fafc;
            padding: 15px;
            line-height: 1.6;
        }
        .header {
            font-size: 20px;
            font-weight: bold;
            text-align: center;
            color: #38bdf8;
            margin-bottom: 20px;
            text-shadow: 0 0 8px rgba(56, 189, 248, 0.5);
        }
        /* çŠ¶æ€æ -é¢œè‰²åˆ†çº§é¢„è­¦ */
        .status-bar {
            background: #1e293b;
            border-radius: 10px;
            padding: 10px;
            margin-bottom: 15px;
            font-size: 13px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        .status-item {
            padding: 4px 8px;
            border-radius: 4px;
        }
        .status-safe { background: #10b981; color: #fff; }
        .status-warning { background: #f59e0b; color: #fff; }
        .status-danger { background: #ef4444; color: #fff; }
        .status-neutral { background: #64748b; color: #fff; }

        /* å¸ç§è¡Œæƒ…çœ‹æ¿-åˆ†å±ç›‘æ§ */
        .coin-dashboard {
            background: #1e293b;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            overflow-x: auto;
        }
        .dashboard-title {
            font-size: 15px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #94a3b8;
        }
        .coin-card {
            display: inline-block;
            width: 120px;
            background: #27374d;
            border-radius: 8px;
            padding: 10px;
            text-align: center;
            margin-right: 10px;
            cursor: pointer;
        }
        .coin-card.active {
            border: 2px solid #38bdf8;
            box-shadow: 0 0 10px rgba(56, 189, 248, 0.5);
        }
        .coin-name { font-size: 16px; font-weight: bold; }
        .coin-price { font-size: 14px; margin: 5px 0; }
        .coin-change { font-size: 12px; }
        .rise { color: #ef4444; }
        .fall { color: #10b981; }

        /* æ ¸å¿ƒåŠŸèƒ½åŒº-å‚»ç“œå¼æŒ‰é’® */
        .func-area {
            background: #1e293b;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }
        .area-title {
            font-size: 15px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #94a3b8;
        }
        .btn-group {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 15px;
        }
        .big-btn {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            touch-action: manipulation;
        }
        .primary-btn { background: #38bdf8; color: #fff; }
        .risk-btn { background: #ef4444; color: #fff; }
        .normal-btn { background: #64748b; color: #fff; }

        /* é£æ§è®¡ç®—å™¨-è‡ªåŠ¨è®¡ç®—+é˜²å‘†æç¤º */
        .risk-calc {
            background: #27374d;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 15px;
        }
        .calc-input {
            width: 100%;
            padding: 8px;
            margin: 5px 0;
            border: 1px solid #475569;
            border-radius: 4px;
            background: #1e293b;
            color: #fff;
            font-size: 13px;
        }
        .calc-result {
            font-size: 13px;
            margin-top: 10px;
            padding: 8px;
            border-radius: 4px;
            background: #0f172a;
        }

        /* è‡ªåŠ¨å§”æ‰˜æ¨¡å—-æ ¸å¿ƒæ–°å¢ */
        .auto-order {
            background: #27374d;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 15px;
        }
        .order-status {
            font-size: 12px;
            padding: 4px;
            border-radius: 4px;
            background: #1e293b;
            margin-top: 8px;
            color: #38bdf8;
        }

        /* ç­–ç•¥æ¨¡æ¿-ä¸€é”®åŠ è½½ */
        .strategy-template {
            background: #27374d;
            border-radius: 8px;
            padding: 12px;
        }
        .template-btn {
            width: 100%;
            padding: 8px;
            margin: 5px 0;
            border: none;
            border-radius: 4px;
            font-size: 13px;
            cursor: pointer;
        }
        .template-shock { background: #f59e0b; color: #fff; } /* éœ‡è¡ */
        .template-trend { background: #10b981; color: #fff; } /* è¶‹åŠ¿ */
        .template-extreme { background: #ef4444; color: #fff; } /* æç«¯ */

        /* é¢„è­¦å¼¹çª—-ä¼˜å…ˆçº§æ’åº */
        .alert-box {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #1e293b;
            border: 3px solid;
            border-radius: 10px;
            padding: 20px;
            width: 90%;
            max-width: 350px;
            z-index: 9999;
            text-align: center;
        }
        .alert-danger { border-color: #ef4444; }
        .alert-warning { border-color: #f59e0b; }
        .alert-info { border-color: #38bdf8; }
        .alert-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .alert-content {
            font-size: 14px;
            margin-bottom: 15px;
            text-align: left;
        }
        .alert-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 5px;
            margin: 0 5px;
            cursor: pointer;
        }

        /* éšè—å…ƒç´  */
        .hide { display: none; }
    </style>
</head>
<body>
    <div class="header">ğŸ’° å‚»ç“œå¼æ¬§æ˜“åˆçº¦äº¤æ˜“åŠ©æ‰‹ | è‡ªåŠ¨å§”æ‰˜ç‰ˆ</div>

    <!-- 1. çŠ¶æ€æ ï¼šä¼˜å…ˆçº§æ’åº+é¢œè‰²é¢„è­¦ -->
    <div class="status-bar">
        <div class="status-item status-safe" id="position-status">ä»“ä½å®‰å…¨</div>
        <div class="status-item status-neutral" id="coin-status">å½“å‰å¸ç§ï¼šBTC</div>
        <div class="status-item status-neutral" id="leverage-status">æ æ†ï¼š10å€</div>
        <div class="status-item status-safe" id="loss-status">å½“æ—¥äºæŸï¼š0/1000 USDT</div>
        <div class="status-item status-neutral" id="order-status">å§”æ‰˜çŠ¶æ€ï¼šæœªå¯åŠ¨</div>
    </div>

    <!-- 2. å¤šå¸ç§è¡Œæƒ…çœ‹æ¿ï¼šåˆ†å±ç›‘æ§+ä¸€é”®åˆ‡æ¢ -->
    <div class="coin-dashboard">
        <div class="dashboard-title">ğŸ“ˆ å…¨å¸ç§è¡Œæƒ…ç›‘æ§</div>
        <div class="coin-card active" onclick="switchCoin('BTC')">
            <div class="coin-name">BTC</div>
            <div class="coin-price">$61937</div>
            <div class="coin-change rise">+0.8%</div>
        </div>
        <div class="coin-card" onclick="switchCoin('ETH')">
            <div class="coin-name">ETH</div>
            <div class="coin-price">$3215</div>
            <div class="coin-change rise">+1.2%</div>
        </div>
        <div class="coin-card" onclick="switchCoin('SOL')">
            <div class="coin-name">SOL</div>
            <div class="coin-price">$124.5</div>
            <div class="coin-change fall">-2.1%</div>
        </div>
        <div class="coin-card" onclick="switchCoin('ADA')">
            <div class="coin-name">ADA</div>
            <div class="coin-price">$0.58</div>
            <div class="coin-change neutral">0%</div>
        </div>
    </div>

    <!-- 3. æ ¸å¿ƒåŠŸèƒ½åŒºï¼šå‚»ç“œå¼æŒ‰é’® -->
    <div class="func-area">
        <div class="area-title">ğŸ¯ æ ¸å¿ƒæ“ä½œ</div>
        <div class="btn-group">
            <button class="big-btn primary-btn" onclick="jumpToOKX()">ä¸€é”®è·³æ¬§æ˜“</button>
            <button class="big-btn normal-btn" onclick="showReview()">æŸ¥çœ‹å¤ç›˜</button>
        </div>
        <div class="btn-group">
            <button class="big-btn normal-btn" onclick="startMonitor()">å¯åŠ¨ç›¯ç›˜</button>
            <button class="big-btn risk-btn" onclick="lockTrade()">é”å®šä»“ä½</button>
        </div>

        <!-- 3.1 é£æ§è®¡ç®—å™¨ï¼šçˆ†ä»“ä»·+ä»“ä½è®¡ç®— -->
        <div class="risk-calc">
            <div class="area-title">ğŸ›¡ï¸ è‡ªåŠ¨é£æ§è®¡ç®—</div>
            æ€»èµ„é‡‘(USDT)ï¼š<input type="number" class="calc-input" id="total-fund" placeholder="è¾“å…¥æ€»èµ„é‡‘" value="10000">
            æ­¢æŸç‚¹æ•°(USDT)ï¼š<input type="number" class="calc-input" id="stop-loss-point" placeholder="æ­¢æŸç‚¹æ•°" value="500">
            <button class="big-btn normal-btn" onclick="calcRisk()">è®¡ç®—çˆ†ä»“ä»·/ä»“ä½</button>
            <div class="calc-result" id="risk-result">ç‚¹å‡»è®¡ç®—ï¼Œè‡ªåŠ¨ç”Ÿæˆå®‰å…¨å¼€ä»“å»ºè®®</div>
        </div>

        <!-- 3.2 è‡ªåŠ¨å§”æ‰˜æ¨¡å—-æ ¸å¿ƒæ–°å¢ -->
        <div class="auto-order">
            <div class="area-title">ğŸš€ æ­¢ç›ˆæ­¢æŸè‡ªåŠ¨å§”æ‰˜</div>
            æ­¢ç›ˆä»·æ ¼(USDT)ï¼š<input type="number" class="calc-input" id="take-profit-price" placeholder="è¾“å…¥æ­¢ç›ˆä»·" value="62500">
            æ­¢æŸä»·æ ¼(USDT)ï¼š<input type="number" class="calc-input" id="stop-loss-price" placeholder="è¾“å…¥æ­¢æŸä»·" value="61500">
            å¼€ä»“æ–¹å‘ï¼š
            <select class="calc-input" id="order-direction" style="margin-top:5px;">
                <option value="long">å¼€å¤š</option>
                <option value="short">å¼€ç©º</option>
            </select>
            <div class="btn-group" style="margin-top:10px;">
                <button class="big-btn primary-btn" onclick="startAutoOrder()">å¯åŠ¨è‡ªåŠ¨å§”æ‰˜</button>
                <button class="big-btn risk-btn" onclick="stopAutoOrder()">åœæ­¢è‡ªåŠ¨å§”æ‰˜</button>
            </div>
            <div class="order-status" id="auto-order-status">ğŸ‘‰ å¯åŠ¨åä»·æ ¼è§¦è¾¾è‡ªåŠ¨è§¦å‘å¹³ä»“ï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œ</div>
        </div>

        <!-- 3.3 ç­–ç•¥æ¨¡æ¿ï¼šä¸€é”®åŠ è½½ -->
        <div class="strategy-template">
            <div class="area-title">ğŸ“‹ ç­–ç•¥æ¨¡æ¿ä¸€é”®é€‰</div>
            <button class="template-btn template-shock" onclick="loadTemplate('shock')">éœ‡è¡è¡Œæƒ…ï¼šä½æ æ†+çª„æ­¢æŸ</button>
            <button class="template-btn template-trend" onclick="loadTemplate('trend')">è¶‹åŠ¿è¡Œæƒ…ï¼šä¸­æ æ†+ç§»åŠ¨æ­¢ç›ˆ</button>
            <button class="template-btn template-extreme" onclick="loadTemplate('extreme')">æç«¯è¡Œæƒ…ï¼š1å€æ æ†+è§‚æœ›</button>
        </div>
    </div>

    <!-- é¢„è­¦å¼¹çª—ï¼šä¼˜å…ˆçº§ä»é«˜åˆ°ä½ -->
    <!-- 1. çˆ†ä»“é¢„è­¦ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰ -->
    <div class="alert-box alert-danger hide" id="liquidation-alert">
        <div class="alert-title" style="color: #ef4444;">âš ï¸ çˆ†ä»“é¢„è­¦</div>
        <div class="alert-content" id="liquidation-content">å½“å‰ä»·æ ¼æ¥è¿‘çˆ†ä»“ä»·ï¼Œè¯·ç«‹å³å‡ä»“/è¡¥ä¿è¯é‡‘ï¼</div>
        <button class="alert-btn" onclick="closeAlert('liquidation-alert')">çŸ¥é“äº†</button>
    </div>

    <!-- 2. äºæŸè¶…é™é¢„è­¦ -->
    <div class="alert-box alert-warning hide" id="loss-alert">
        <div class="alert-title" style="color: #f59e0b;">âš ï¸ äºæŸè­¦å‘Š</div>
        <div class="alert-content" id="loss-content">å½“æ—¥äºæŸå·²è¾¾80%ï¼Œå³å°†è§¦å‘é”å®šï¼</div>
        <button class="alert-btn" onclick="closeAlert('loss-alert')">çŸ¥é“äº†</button>
    </div>

    <!-- 3. ä»·æ ¼é¢„è­¦/å§”æ‰˜è§¦å‘æé†’ -->
    <div class="alert-box alert-info hide" id="price-alert">
        <div class="alert-title" style="color: #38bdf8;">ğŸ“¢ ä»·æ ¼/å§”æ‰˜æé†’</div>
        <div class="alert-content" id="price-content">BTCå·²è§¦è¾¾æ­¢æŸä»·$61500ï¼</div>
        <button class="alert-btn" onclick="closeAlert('price-alert')">çŸ¥é“äº†</button>
    </div>

    <!-- 4. å¤ç›˜æŠ¥å‘Š -->
    <div class="alert-box alert-info hide" id="review-alert">
        <div class="alert-title" style="color: #38bdf8;">â° æ¯å°æ—¶å¤ç›˜</div>
        <div class="alert-content" id="review-content">...</div>
        <button class="alert-btn" onclick="closeAlert('review-alert')">çŸ¥é“äº†</button>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let currentCoin = 'BTC';
        let isTradeLocked = false;
        let currentLeverage = 10;
        let isAutoOrderRunning = false; // è‡ªåŠ¨å§”æ‰˜çŠ¶æ€
        let autoOrderTimer = null; // å§”æ‰˜ç›‘æ§å®šæ—¶å™¨
        const maxDailyLoss = 1000; // å½“æ—¥æœ€å¤§äºæŸé™é¢
        const coinLeverageLimit = { BTC: 20, ETH: 15, SOL: 10, ADA: 10 }; // å¸ç§æ æ†ä¸Šé™

        // å¸ç§æ•°æ®
        const coinData = {
            BTC: { price: 61937, stopLoss: 61500, fundingRate: 0.015, volume: 12000 },
            ETH: { price: 3215, stopLoss: 3180, fundingRate: 0.012, volume: 8000 },
            SOL: { price: 124.5, stopLoss: 126, fundingRate: 0.025, volume: 15000 },
            ADA: { price: 0.58, stopLoss: 0.55, fundingRate: 0.008, volume: 5000 }
        };

        // 1. åˆ‡æ¢å¸ç§ï¼šè‡ªåŠ¨åŒ¹é…æ æ†ä¸Šé™
        function switchCoin(coin) {
            if (isTradeLocked) { alert('å·²é”å®šä»“ä½ï¼Œæ— æ³•åˆ‡æ¢ï¼'); return; }
            currentCoin = coin;
            // æ›´æ–°å¡ç‰‡æ ·å¼
            document.querySelectorAll('.coin-card').forEach(card => card.classList.remove('active'));
            event.target.classList.add('active');
            // æ›´æ–°çŠ¶æ€
            document.getElementById('coin-status').innerText = `å½“å‰å¸ç§ï¼š${coin}`;
            currentLeverage = coinLeverageLimit[coin];
            document.getElementById('leverage-status').innerText = `æ æ†ï¼š${currentLeverage}å€`;
            // è‡ªåŠ¨å¡«å……é»˜è®¤æ­¢ç›ˆæ­¢æŸä»·
            document.getElementById('stop-loss-price').value = coinData[coin].stopLoss;
            document.getElementById('take-profit-price').value = coin === 'BTC' ? 62500 : coin === 'ETH' ? 3300 : coin === 'SOL' ? 118 : 0.6;
            // ä»·æ ¼é¢„è­¦åˆ¤æ–­
            if (coinData[coin].price <= coinData[coin].stopLoss) {
                showAlert('price-alert', `âš ï¸ ${coin}å·²è§¦è¾¾æ­¢æŸä»·$${coinData[coin].stopLoss}ï¼`);
            }
        }

        // 2. é£æ§è®¡ç®—ï¼šçˆ†ä»“ä»·+å®‰å…¨ä»“ä½ï¼ˆå‚»ç“œå¼ç»“æœï¼‰
        function calcRisk() {
            const totalFund = parseFloat(document.getElementById('total-fund').value) || 0;
            const stopLossPoint = parseFloat(document.getElementById('stop-loss-point').value) || 0;
            if (totalFund <= 0 || stopLossPoint <= 0) {
                document.getElementById('risk-result').innerText = 'è¯·è¾“å…¥æœ‰æ•ˆçš„èµ„é‡‘/æ­¢æŸç‚¹æ•°ï¼';
                return;
            }
            // çˆ†ä»“ä»·å…¬å¼ï¼ˆç®€åŒ–ç‰ˆï¼Œé€šç”¨æ°¸ç»­åˆçº¦ï¼‰
            const liquidationPrice = (coinData[currentCoin].price * (1 - 0.01 * currentLeverage)).toFixed(2);
            // å®‰å…¨ä»“ä½ = æ€»èµ„é‡‘*2% / æ­¢æŸç‚¹æ•° * æ æ†
            const safePosition = ((totalFund * 0.02 / stopLossPoint) * currentLeverage).toFixed(4);
            // å‚»ç“œå¼ç»“æœå±•ç¤º
            document.getElementById('risk-result').innerHTML = `
                ğŸš¨ çˆ†ä»“ä»·ï¼š$${liquidationPrice} | ğŸ›¡ï¸ å®‰å…¨å¼€ä»“é‡ï¼š${safePosition} ${currentCoin}
                <br>ğŸ‘‰ æç¤ºï¼šä»·æ ¼ä½äºçˆ†ä»“ä»·ä¼šå¼ºåˆ¶å¹³ä»“ï¼Œå¼€ä»“åˆ«è¶…è¿™ä¸ªæ•°ï¼
            `;
            // çˆ†ä»“é¢„è­¦åˆ¤æ–­
            if (coinData[currentCoin].price - parseFloat(liquidationPrice) < 100) {
                showAlert('liquidation-alert', `å½“å‰ä»·æ ¼$${coinData[currentCoin].price}ï¼Œçˆ†ä»“ä»·$${liquidationPrice}ï¼Œåªå‰©$${(coinData[currentCoin].price - parseFloat(liquidationPrice)).toFixed(2)}ç©ºé—´ï¼`);
            }
        }

        // 3. ç­–ç•¥æ¨¡æ¿ä¸€é”®åŠ è½½ï¼šè‡ªåŠ¨å¡«å……å‚æ•°ï¼ˆå‚»ç“œå¼ï¼‰
        function loadTemplate(type) {
            let leverage, tpRate, slRate, tip;
            const basePrice = coinData[currentCoin].price;
            if (type === 'shock') {
                leverage = currentLeverage / 2;
                tpRate = 0.01; // æ­¢ç›ˆ1%
                slRate = 0.005; // æ­¢æŸ0.5%
                tip = 'éœ‡è¡è¡Œæƒ…ï¼šä½æ æ†æŠ—æ³¢åŠ¨ï¼Œå°èµšå°±è·‘ï¼';
            } else if (type === 'trend') {
                leverage = currentLeverage;
                tpRate = 0.03; // æ­¢ç›ˆ3%
                slRate = 0.01; // æ­¢æŸ1%
                tip = 'è¶‹åŠ¿è¡Œæƒ…ï¼šé¡ºåŠ¿å¼€ä»“ï¼Œæ­¢æŸè®¾å®½ä¸€ç‚¹ï¼';
            } else {
                leverage = 1;
                tpRate = 0;
                slRate = 0;
                tip = 'æç«¯è¡Œæƒ…ï¼šè§‚æœ›ä¸ºä¸»ï¼Œ1å€æ æ†ä¿æœ¬é‡‘ï¼';
            }
            currentLeverage = leverage;
            document.getElementById('leverage-status').innerText = `æ æ†ï¼š${leverage}å€`;
            // è‡ªåŠ¨å¡«å……æ­¢ç›ˆæ­¢æŸä»·
            if (tpRate > 0) {
                document.getElementById('take-profit-price').value = (basePrice * (1 + tpRate)).toFixed(2);
                document.getElementById('stop-loss-price').value = (basePrice * (1 - slRate)).toFixed(2);
            }
            alert(`âœ… å·²åŠ è½½ã€${type === 'shock' ? 'éœ‡è¡' : type === 'trend' ? 'è¶‹åŠ¿' : 'æç«¯'}ã€‘ç­–ç•¥\n${tip}`);
        }

        // 4. æ ¸å¿ƒæ–°å¢ï¼šå¯åŠ¨è‡ªåŠ¨å§”æ‰˜ç›‘æ§
        function startAutoOrder() {
            if (isTradeLocked) { alert('å·²é”å®šä»“ä½ï¼Œæ— æ³•å¯åŠ¨å§”æ‰˜ï¼'); return; }
            if (isAutoOrderRunning) { alert('è‡ªåŠ¨å§”æ‰˜å·²åœ¨è¿è¡Œä¸­ï¼'); return; }
            const tpPrice = parseFloat(document.getElementById('take-profit-price').value);
            const slPrice = parseFloat(document.getElementById('stop-loss-price').value);
            const direction = document.getElementById('order-direction').value;
            if (isNaN(tpPrice) || isNaN(slPrice)) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„æ­¢ç›ˆ/æ­¢æŸä»·æ ¼ï¼');
                return;
            }
            // å¯åŠ¨å®šæ—¶å™¨ï¼Œæ¯ç§’ç›‘æ§ä»·æ ¼
            isAutoOrderRunning = true;
            document.getElementById('order-status').innerText = `å§”æ‰˜çŠ¶æ€ï¼šè¿è¡Œä¸­ï¼ˆ${direction} | æ­¢ç›ˆ$${tpPrice} | æ­¢æŸ$${slPrice}ï¼‰`;
            document.getElementById('auto-order-status').innerText = `âœ… è‡ªåŠ¨å§”æ‰˜å·²å¯åŠ¨ï¼Œæ­£åœ¨ç›‘æ§${currentCoin}ä»·æ ¼...`;
            autoOrderTimer = setInterval(() => {
                const currentPrice = coinData[currentCoin].price;
                // æ¨¡æ‹Ÿä»·æ ¼æ³¢åŠ¨ï¼ˆå®é™…éœ€å¯¹æ¥æ¬§æ˜“APIå®æ—¶ä»·æ ¼ï¼‰
                coinData[currentCoin].price = currentPrice + (Math.random() - 0.5) * 10;
                // æ­¢ç›ˆè§¦å‘åˆ¤æ–­
                if ((direction === 'long' && currentPrice >= tpPrice) || (direction === 'short' && currentPrice <= tpPrice)) {
                    showAlert('price-alert', `ğŸ‰ ${currentCoin}å·²è§¦è¾¾æ­¢ç›ˆä»·$${tpPrice}ï¼\nè‡ªåŠ¨å¹³ä»“å§”æ‰˜å·²è§¦å‘ï¼`);
                    stopAutoOrder(); // è§¦å‘ååœæ­¢ç›‘æ§
                }
                // æ­¢æŸè§¦å‘åˆ¤æ–­
                if ((direction === 'long' && currentPrice <= slPrice) || (direction === 'short' && currentPrice >= slPrice)) {
                    showAlert('price-alert', `âš ï¸ ${currentCoin}å·²è§¦è¾¾æ­¢æŸä»·$${slPrice}ï¼\nè‡ªåŠ¨å¹³ä»“å§”æ‰˜å·²è§¦å‘ï¼`);
                    stopAutoOrder(); // è§¦å‘ååœæ­¢ç›‘æ§
                }
            }, 1000);
        }

        // åœæ­¢è‡ªåŠ¨å§”æ‰˜ç›‘æ§
        function stopAutoOrder() {
            if (!isAutoOrderRunning) { return; }
            clearInterval(autoOrderTimer);
            isAutoOrderRunning = false;
            document.getElementById('order-status').innerText = 'å§”æ‰˜çŠ¶æ€ï¼šæœªå¯åŠ¨';
            document.getElementById('auto-order-status').innerText = 'ğŸ‘‰ å¯åŠ¨åä»·æ ¼è§¦è¾¾è‡ªåŠ¨è§¦å‘å¹³ä»“ï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œ';
        }

        // 5. é¢„è­¦å¼¹çª—ï¼šä¼˜å…ˆçº§æ§åˆ¶ï¼ˆçˆ†ä»“>äºæŸ>ä»·æ ¼>å¤ç›˜ï¼‰
        function showAlert(alertId, content) {
            // å…ˆå…³é—­ä½ä¼˜å…ˆçº§å¼¹çª—
            if (alertId === 'liquidation-alert') {
                closeAlert('loss-alert');
                closeAlert('price-alert');
                closeAlert('review-alert');
            } else if (alertId === 'loss-alert') {
                closeAlert('price-alert');
                closeAlert('review-alert');
            }
            document.getElementById(`${alertId.split('-')[0]}-content`).innerText = content;
            document.getElementById(alertId).classList.remove('hide');
        }
        function closeAlert(alertId) {
            document.getElementById(alertId).classList.add('hide');
        }

        // 6. å…¶ä»–åŠŸèƒ½ï¼šè·³æ¬§æ˜“/ç›¯ç›˜/é”å®š/å¤ç›˜
        function jumpToOKX() {
            const okxUrl = `okex://trade/${currentCoin.toLowerCase()}-usdt/contract`;
            window.location.href = okxUrl;
            setTimeout(() => window.open(`https://www.okx.com/trade/contract/${currentCoin.toLowerCase()}-usdt`), 2000);
        }
        function startMonitor() {
            alert('âœ… å·²å¯åŠ¨è‡ªåŠ¨ç›¯ç›˜ï¼Œä»·æ ¼è§¦è¾¾æ­¢æŸ/æ­¢ç›ˆä¼šæé†’ä½ ï¼');
        }
        function lockTrade() {
            isTradeLocked = !isTradeLocked;
            if (isTradeLocked) { stopAutoOrder(); } // é”å®šæ—¶åœæ­¢å§”æ‰˜
            document.getElementById('position-status').innerText = isTradeLocked ? 'ä»“ä½å·²é”å®š' : 'ä»“ä½å®‰å…¨';
            document.getElementById('position-status').className = isTradeLocked ? 'status-item status-danger' : 'status-item status-safe';
            alert(isTradeLocked ? 'ğŸ”’ å·²é”å®šæ‰€æœ‰äº¤æ˜“æ“ä½œï¼' : 'ğŸ”“ å·²è§£é”ä»“ä½ï¼Œæ³¨æ„é£é™©ï¼');
        }
        function showReview() {
            const hour = new Date().getHours();
            const data = coinData[currentCoin];
            const sentiment = data.fundingRate > 0.02 ? 'å¤šå¤´ç‹‚çƒ­ï¼Œè­¦æƒ•å›è°ƒ' : data.fundingRate < -0.01 ? 'ç©ºå¤´ä¸»å¯¼ï¼Œè°¨æ…æŠ„åº•' : 'å¸‚åœºä¸­æ€§';
            const reviewText = `
ã€æ—¶é—´ã€‘${hour}:00
ã€å¸ç§ã€‘${currentCoin}
ã€ä»·æ ¼ã€‘$${data.price.toFixed(2)}
ã€èµ„é‡‘æƒ…ç»ªã€‘${sentiment}
ã€æ“ä½œå»ºè®®ã€‘${currentCoin === 'BTC' ? 'æŒæœ‰å¤šå•ï¼Œæ­¢æŸ$61500' : 'è§‚æœ›ä¸ºä¸»ï¼Œçªç ´å†å¼€ä»“'}
            `;
            document.getElementById('review-content').innerText = reviewText;
            showAlert('review-alert', reviewText);
        }

        // å®šæ—¶ä»»åŠ¡ï¼šæ¯å°æ—¶å¤ç›˜+äºæŸç›‘æ§
        setInterval(() => {
            showReview(); // æ¯å°æ—¶è‡ªåŠ¨å¤ç›˜
            // æ¨¡æ‹ŸäºæŸç›‘æ§ï¼ˆå®é™…éœ€å¯¹æ¥è´¦æˆ·ï¼‰
            const randomLoss = Math.random() * 800;
            document.getElementById('loss-status').innerText = `å½“æ—¥äºæŸï¼š${randomLoss.toFixed(0)}/${maxDailyLoss} USDT`;
            if (randomLoss > maxDailyLoss * 0.8) {
                showAlert('loss-alert', `å½“æ—¥äºæŸ${randomLoss.toFixed(0)} USDTï¼Œå·²è¾¾é™é¢80%ï¼`);
            }
        }, 3600000);

        // é¡µé¢å…³é—­æ—¶åœæ­¢å®šæ—¶å™¨
        window.onbeforeunload = function() {
            stopAutoOrder();
        };
    </script>
</body>
</html>