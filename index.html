<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>豆包搭档·合约交易工具【小白极速版】</title>
    <style>
        /* 欧易同源深色主题+大字报样式 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Microsoft YaHei", sans-serif;
        }
        body {
            background-color: #121212;
            color: #ffffff;
            padding: 20px;
        }
        .header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #333333;
        }
        .header h1 {
            color: #27ae60;
            font-size: 28px;
        }
        .shortcut-tips {
            margin-top: 10px;
            font-size: 14px;
            color: #999999;
        }
        /* 核心：交易信号大字报 */
        .signal-banner {
            background: linear-gradient(90deg, #27ae60, #2c3e50);
            color: white;
            text-align: center;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 24px;
            font-weight: bold;
            letter-spacing: 2px;
        }
        .signal-banner.strong-long {background: linear-gradient(90deg, #e74c3c, #c0392b);}
        .signal-banner.strong-short {background: linear-gradient(90deg, #3498db, #2980b9);}
        .signal-banner.wait {background: linear-gradient(90deg, #f39c12, #d35400);}
        /* 自定义币种添加区 */
        .custom-coin-add {
            background-color: #1e1e1e;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            border: 1px solid #333333;
        }
        .add-coin-title {
            color: #27ae60;
            font-size: 18px;
            margin-bottom: 10px;
        }
        .add-coin-form {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .add-coin-form input {
            flex: 1;
            min-width: 150px;
            padding: 8px;
            background-color: #2c2c2c;
            color: #ffffff;
            border: 1px solid #444444;
            border-radius: 4px;
        }
        .add-coin-form select {
            padding: 8px;
            background-color: #2c2c2c;
            color: #ffffff;
            border: 1px solid #444444;
            border-radius: 4px;
        }
        .add-coin-btn {
            background-color: #27ae60;
            color: #ffffff;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
        }
        /* 多币种监控容器 - 自适应+高亮信号 */
        .monitor-container {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
        }
        .coin-card {
            background-color: #1e1e1e;
            border-radius: 8px;
            padding: 15px;
            border: 2px solid #333333;
            width: calc(25% - 15px);
            min-width: 250px;
        }
        .coin-card.long {border-color: #e74c3c;}
        .coin-card.short {border-color: #3498db;}
        .coin-card.wait {border-color: #f39c12;}
        .coin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .coin-name {
            font-weight: bold;
            color: #27ae60;
            font-size: 18px;
        }
        .exchange-select {
            background-color: #2c2c2c;
            color: #ffffff;
            border: 1px solid #444444;
            border-radius: 4px;
            padding: 3px 8px;
            font-size: 12px;
        }
        .coin-price {
            font-size: 22px;
            margin: 10px 0;
            color: #ffffff;
        }
        .price-change {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .rise {color: #e74c3c;}
        .fall {color: #27ae60;}
        /* 核心：欧易一键下单参数 */
        .okx-order-params {
            background-color: #2c2c2c;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            font-size: 14px;
            line-height: 1.8;
        }
        .okx-order-params span {
            color: #27ae60;
            font-weight: bold;
        }
        .kline-area {
            height: 120px;
            background-color: #2c2c2c;
            border-radius: 4px;
            margin: 10px 0;
            position: relative;
            overflow: hidden;
        }
        .kline-placeholder {
            text-align: center;
            line-height: 120px;
            color: #999999;
            font-size: 12px;
        }
        .indicator-btn {
            background-color: #27ae60;
            color: #ffffff;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 5px;
            font-size: 12px;
        }
        /* 策略、风险区 - 简化输入项 */
        .strategy-risk-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        .strategy-card, .risk-card {
            background-color: #1e1e1e;
            border-radius: 8px;
            padding: 20px;
            border: 1px solid #333333;
        }
        .card-title {
            color: #27ae60;
            margin-bottom: 15px;
            font-size: 18px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .form-group {
            margin-bottom: 12px;
        }
        .form-group label {
            display: block;
            font-size: 14px;
            margin-bottom: 5px;
            color: #cccccc;
        }
        .form-group input, .form-group select {
            width: 100%;
            padding: 8px;
            background-color: #2c2c2c;
            color: #ffffff;
            border: 1px solid #444444;
            border-radius: 4px;
        }
        .calc-btn {
            background-color: #27ae60;
            color: #ffffff;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
        }
        .result-area {
            margin-top: 15px;
            padding: 10px;
            background-color: #2c2c2c;
            border-radius: 4px;
            font-size: 14px;
            white-space: pre-wrap;
        }
        .ai-log-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .ai-card, .log-card {
            background-color: #1e1e1e;
            border-radius: 8px;
            padding: 20px;
            border: 1px solid #333333;
        }
        .ai-content {
            margin-top: 15px;
            padding: 10px;
            background-color: #2c2c2c;
            border-radius: 4px;
            min-height: 100px;
            font-size: 14px;
        }
        .log-content {
            margin-top: 15px;
            padding: 10px;
            background-color: #2c2c2c;
            border-radius: 4px;
            min-height: 100px;
            font-size: 12px;
            white-space: pre-wrap;
        }
        .add-log-btn {
            background-color: #27ae60;
            color: #ffffff;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
        }
        /* 响应式适配 - 手机也能看 */
        @media (max-width: 1200px) {
            .coin-card {width: calc(33.33% - 15px);}
            .strategy-risk-container, .ai-log-container {grid-template-columns: 1fr;}
        }
        @media (max-width: 768px) {
            .coin-card {width: calc(50% - 15px);}
            .signal-banner {font-size: 20px;}
        }
        @media (max-width: 480px) {
            .coin-card {width: 100%;}
            .signal-banner {font-size: 18px;}
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>豆包搭档·合约交易工具【小白极速版】</h1>
        <div class="shortcut-tips">
            小白用法：看信号 → 抄参数 → 去欧易下单 | 快捷键：F1=切换周期 F2=清空预警 F3=风险计算 F4=指标开关
        </div>
    </div>

    <!-- 核心：交易信号大字报 -->
    <div class="signal-banner wait" id="global-signal">
        等待行情确认
    </div>

    <!-- 自定义币种添加区（一键补全映射） -->
    <div class="custom-coin-add">
        <div class="add-coin-title">自定义币种添加（输入代码如 APT/ARB，小白不用管ID）</div>
        <div class="add-coin-form">
            <input type="text" id="new-coin-code" placeholder="币种代码（如 APT）" maxlength="5">
            <input type="text" id="new-coin-id" placeholder="CoinGecko ID（留空自动补）" style="display:none">
            <select id="new-coin-exchange">
                <option>欧易</option>
                <option>币安</option>
                <option>火币</option>
            </select>
            <button class="add-coin-btn" onclick="addCustomCoin()">添加币种</button>
        </div>
    </div>

    <!-- 多币种监控容器 -->
    <div class="monitor-container" id="monitor-container">
        <!-- 默认币种：BTC-USDT -->
        <div class="coin-card wait" data-coin="BTC" data-id="bitcoin">
            <div class="coin-header">
                <span class="coin-name">BTC-USDT</span>
                <select class="exchange-select">
                    <option>欧易</option>
                    <option>币安</option>
                    <option>火币</option>
                </select>
            </div>
            <div class="coin-price">价格：<span class="real-price">--</span> USDT</div>
            <div class="price-change fall">24h涨跌幅：<span class="real-change">--</span>%</div>
            <!-- 核心：欧易一键下单参数 -->
            <div class="okx-order-params">
                方向：<span id="btc-direction">观望</span> | 杠杆：<span>5倍（小白推荐）</span><br>
                止盈：<span id="btc-tp">--</span> USDT | 止损：<span id="btc-sl">--</span> USDT<br>
                仓位：<span id="btc-position">总资金的5%</span>
            </div>
            <div class="kline-area">
                <div class="kline-placeholder">15m K线 · 信号自动判断</div>
            </div>
            <button class="indicator-btn" onclick="toggleIndicator(this)">F4 指标开关</button>
        </div>
        <!-- 默认币种：ETH-USDT -->
        <div class="coin-card wait" data-coin="ETH" data-id="ethereum">
            <div class="coin-header">
                <span class="coin-name">ETH-USDT</span>
                <select class="exchange-select">
                    <option>欧易</option>
                    <option>币安</option>
                    <option>火币</option>
                </select>
            </div>
            <div class="coin-price">价格：<span class="real-price">--</span> USDT</div>
            <div class="price-change rise">24h涨跌幅：<span class="real-change">--</span>%</div>
            <div class="okx-order-params">
                方向：<span id="eth-direction">观望</span> | 杠杆：<span>5倍（小白推荐）</span><br>
                止盈：<span id="eth-tp">--</span> USDT | 止损：<span id="eth-sl">--</span> USDT<br>
                仓位：<span id="eth-position">总资金的5%</span>
            </div>
            <div class="kline-area">
                <div class="kline-placeholder">15m K线 · 信号自动判断</div>
            </div>
            <button class="indicator-btn" onclick="toggleIndicator(this)">F4 指标开关</button>
        </div>
        <!-- 默认币种：SOL-USDT -->
        <div class="coin-card wait" data-coin="SOL" data-id="solana">
            <div class="coin-header">
                <span class="coin-name">SOL-USDT</span>
                <select class="exchange-select">
                    <option>欧易</option>
                    <option>币安</option>
                    <option>火币</option>
                </select>
            </div>
            <div class="coin-price">价格：<span class="real-price">--</span> USDT</div>
            <div class="price-change fall">24h涨跌幅：<span class="real-change">--</span>%</div>
            <div class="okx-order-params">
                方向：<span id="sol-direction">观望</span> | 杠杆：<span>3倍（小白推荐）</span><br>
                止盈：<span id="sol-tp">--</span> USDT | 止损：<span id="sol-sl">--</span> USDT<br>
                仓位：<span id="sol-position">总资金的3%</span>
            </div>
            <div class="kline-area">
                <div class="kline-placeholder">15m K线 · 信号自动判断</div>
            </div>
            <button class="indicator-btn" onclick="toggleIndicator(this)">F4 指标开关</button>
        </div>
    </div>

    <!-- 策略与风险控制区（简化输入） -->
    <div class="strategy-risk-container">
        <div class="strategy-card">
            <div class="card-title">
                <span>小白策略生成器</span>
                <span style="font-size:12px;color:#999">输入资金自动算仓位</span>
            </div>
            <div class="form-group">
                <label>选择币种</label>
                <select id="strategy-coin">
                    <option value="BTC">BTC-USDT</option>
                    <option value="ETH">ETH-USDT</option>
                    <option value="SOL">SOL-USDT</option>
                </select>
            </div>
            <div class="form-group">
                <label>你的总资金（USDT）</label>
                <input type="number" id="strategy-capital" placeholder="如 1000" value="1000">
            </div>
            <div class="form-group">
                <label>选择策略（小白选默认）</label>
                <select id="strategy-type">
                    <option value="tp-sl">止盈止损（小白默认）</option>
                    <option value="grid">网格交易（震荡用）</option>
                    <option value="break">突破交易（趋势用）</option>
                </select>
            </div>
            <button class="calc-btn" onclick="calcStrategy()">一键生成下单参数</button>
            <div class="result-area" id="strategy-result">点击生成参数，直接去欧易下单</div>
        </div>
        <div class="risk-card">
            <div class="card-title">
                <span>小白风险保护器</span>
                <span style="font-size:12px;color:#999">防止爆仓，自动警告</span>
            </div>
            <div class="form-group">
                <label>保证金使用率（%）</label>
                <input type="number" id="margin-rate" placeholder="如 50" oninput="checkMargin()">
                <div id="margin-alert" style="margin-top:5px;font-size:12px;color:#f39c12"></div>
            </div>
            <div class="form-group">
                <label>你的总资金（USDT）</label>
                <input type="number" id="risk-capital" placeholder="如 1000" value="1000">
            </div>
            <button class="calc-btn" onclick="calcMaxLoss()">F3 计算最大可亏金额</button>
            <div class="result-area" id="risk-result">点击计算，超过就会爆仓！</div>
        </div>
    </div>

    <!-- AI解读与交易日志（人话版） -->
    <div class="ai-log-container">
        <div class="ai-card">
            <div class="card-title">
                <span>人话版行情解读（小白必看）</span>
                <span style="font-size:12px;color:#999">每30秒自动更新</span>
            </div>
            <div class="ai-content" id="ai-analysis">
                【BTC】价格没出来，暂时观望，别下单！
                【ETH】价格没出来，暂时观望，别下单！
                【SOL】价格没出来，暂时观望，别下单！
                <br><br>
                <strong>小白提示：</strong>只做「开多」「开空」信号的币种，观望的别碰！
            </div>
        </div>
        <div class="log-card">
            <div class="card-title">
                <span>交易记录本本（记盈亏）</span>
                <span style="font-size:12px;color:#999">记下来才能赚钱</span>
            </div>
            <div class="form-group">
                <label>记录格式：币种+方向+盈亏（如 BTC开多 赚50U）</label>
                <input type="text" id="log-content" placeholder="BTC开多 赚50U">
            </div>
            <button class="add-log-btn" onclick="addTradeLog()">添加记录</button>
            <div class="log-content" id="trade-log">暂无交易记录，赚钱从记录开始！</div>
        </div>
    </div>

    <script>
        // 核心：币种ID映射表（小白不用管，自动补）
        const coinIdMap={
            BTC: "bitcoin",ETH: "ethereum",SOL: "solana",
            APT: "aptos",ARB: "arbitrum",ADA: "cardano",
            DOT: "polkadot",MATIC: "polygon",AVAX: "avalanche-2"
        };
        // 核心：交易信号判断规则（小白不用懂，直接看结果）
        function getSignal(changeRate) {
            if (changeRate > 2) return {type: "strong-long", text: "强势开多", color: "#e74c3c"};
            else if (changeRate < -2) return {type: "strong-short", text: "强势开空", color: "#3498db"};
            else return {type: "wait", text: "观望", color: "#f39c12"};
        }

        // 指标开关（简化）
        function toggleIndicator(btn) {
            const kline = btn.previousElementSibling;
            const placeholder = kline.querySelector('.kline-placeholder');
            placeholder.textContent = placeholder.textContent.includes('指标') 
                ? '15m K线 · 信号自动判断' 
                : 'MACD+RSI · 信号自动判断';
        }

        // 策略计算（小白版：直接出欧易下单参数）
        function calcStrategy() {
            const coin = document.getElementById('strategy-coin').value;
            const capital = parseFloat(document.getElementById('strategy-capital').value) || 1000;
            const type = document.getElementById('strategy-type').value;
            const price = parseFloat(document.querySelector(`.coin-card[data-coin="${coin}"] .real-price`).textContent) || 0;
            
            if (price === 0) {
                document.getElementById('strategy-result').textContent = "行情还没加载出来，等30秒再试！";
                return;
            }

            let result = '';
            // 止盈止损（小白默认）
            if (type === 'tp-sl') {
                const tpRate = 3; // 小白默认止盈3%
                const slRate = 2; // 小白默认止损2%
                const tpPrice = (price * (1 + tpRate / 100)).toFixed(2);
                const slPrice = (price * (1 - slRate / 100)).toFixed(2);
                const position = (capital * 0.05).toFixed(2); // 小白默认仓位5%
                const leverage = coin === 'SOL' ? 3 : 5; // SOL波动大，3倍杠杆
                result = `【欧易${coin}下单参数 - 小白直接抄】
1. 方向：${getSignal(parseFloat(document.querySelector(`.coin-card[data-coin="${coin}"] .real-change`).textContent)).text}
2. 杠杆：${leverage}倍（千万别加杠杆！）
3. 开仓价：${price.toFixed(2)} USDT
4. 止盈价：${tpPrice} USDT | 止损价：${slPrice} USDT
5. 下单金额：${position} USDT（总资金的5%，别多买！）
6. 操作步骤：打开欧易→合约→${coin}USDT→限价开仓→填上面的价格→确认！`;
            }
            // 网格交易（震荡用）
            else if (type === 'grid') {
                const gridNum = 5; // 小白默认5格
                const range = 5; // 小白默认±5%
                const step = (price * range / 100 / gridNum).toFixed(2);
                const start = (price * (1 - range / 100)).toFixed(2);
                const end = (price * (1 + range / 100)).toFixed(2);
                result = `【欧易${coin}网格参数 - 震荡行情用】
1. 网格数量：5格 | 价格区间：${start} - ${end} USDT
2. 每格金额：${(capital / gridNum / 2).toFixed(2)} USDT（别满仓！）
3. 操作步骤：欧易→策略交易→网格交易→填上面的参数→启动！
4. 小白提示：单边行情千万别用网格，会亏哭！`;
            }
            // 突破交易（趋势用）
            else if (type === 'break') {
                const breakRate = 0.5; // 突破回踩0.5%确认
                const confirmPrice = (price * (1 - breakRate / 100)).toFixed(2);
                const slPrice = (confirmPrice * 0.99).toFixed(2);
                result = `【欧易${coin}突破参数 - 趋势行情用】
1. 突破确认：价格涨到${price.toFixed(2)}后，回落到${confirmPrice}再买
2. 止损价：${slPrice} USDT（突破失败就跑！）
3. 下单金额：${(capital * 0.03).toFixed(2)} USDT（总资金的3%）
4. 小白提示：没突破前千万别提前买！`;
            }
            document.getElementById('strategy-result').textContent = result;
        }

        // 保证金预警（小白版：强制弹窗警告）
        function checkMargin() {
            const rate = parseFloat(document.getElementById('margin-rate').value) || 0;
            const alert = document.getElementById('margin-alert');
            if (rate < 50) {
                alert.textContent = "✅ 安全！可以正常操作";
                alert.style.color = "#27ae60";
            } else if (rate < 70) {
                alert.textContent = "⚠️ 仓位偏重！赶紧减仓20%";
                alert.style.color = "#f39c12";
            } else {
                alert.textContent = "❌ 危险！马上爆仓！立即减仓！";
                alert.style.color = "#e74c3c";
                alert('【小白警告】保证金使用率超过70%，再不平仓就要爆仓了！');
            }
        }

        // 最大亏损计算（小白版：直接说能亏多少）
        function calcMaxLoss() {
            const capital = parseFloat(document.getElementById('risk-capital').value) || 1000;
            const maxLossRate = 2; // 小白最大可亏2%
            const maxLoss = (capital * maxLossRate / 100).toFixed(2);
            document.getElementById('risk-result').textContent = `【小白最大可亏金额】
1. 你的总资金：${capital} USDT
2. 单次最大能亏：${maxLoss} USDT（超过这个数就止损！）
3. 止损原则：亏到${maxLoss} USDT，立即平仓，别犹豫！`;
        }

        // 交易日志添加（简化）
        function addTradeLog() {
            const content = document.getElementById('log-content').value.trim();
            if (!content) return;
            const time = new Date().toLocaleString();
            const log = document.getElementById('trade-log');
            log.textContent = log.textContent === '暂无交易记录，赚钱从记录开始！' 
                ? `[${time}] ${content}` 
                : `${log.textContent}\n[${time}] ${content}`;
            document.getElementById('log-content').value = '';
        }

        // 自定义币种添加（小白版：自动补ID）
        function addCustomCoin() {
            const code = document.getElementById('new-coin-code').value.trim().toUpperCase();
            const exchange = document.getElementById('new-coin-exchange').value;
            if (!code) {
                alert('请输入币种代码，比如APT、ARB！');
                return;
            }
            if (document.querySelector(`.coin-card[data-coin="${code}"]`)) {
                alert(`${code}-USDT已经在列表里了！`);
                return;
            }
            // 自动补全CoinGecko ID
            const coinId = coinIdMap[code] || code.toLowerCase();
            document.getElementById('new-coin-id').value = coinId;

            const card = document.createElement('div');
            card.className = 'coin-card wait';
            card.dataset.coin = code;
            card.dataset.id = coinId;
            // 小白默认参数：杠杆3倍，仓位3%
            card.innerHTML = `
                <div class="coin-header">
                    <span class="coin-name">${code}-USDT</span>
                    <select class="exchange-select">
                        <option ${exchange === '欧易' ? 'selected' : ''}>欧易</option>
                        <option ${exchange === '币安' ? 'selected' : ''}>币安</option>
                        <option ${exchange === '火币' ? 'selected' : ''}>火币</option>
                    </select>
                </div>
                <div class="coin-price">价格：<span class="real-price">--</span> USDT</div>
                <div class="price-change fall">24h涨跌幅：<span class="real-change">--</span>%</div>
                <div class="okx-order-params">
                    方向：<span>观望</span> | 杠杆：<span>3倍（小白推荐）</span><br>
                    止盈：<span>--</span> USDT | 止损：<span>--</span> USDT<br>
                    仓位：<span>总资金的3%</span>
                </div>
                <div class="kline-area">
                    <div class="kline-placeholder">15m K线 · 信号自动判断</div>
                </div>
                <button class="indicator-btn" onclick="toggleIndicator(this)">F4 指标开关</button>
            `;
            document.getElementById('monitor-container').appendChild(card);
            document.getElementById('new-coin-code').value = '';
            fetchCoinPrice(code, card);
            // 更新策略币种选择
            const option = document.createElement('option');
            option.value = code;
            option.textContent = `${code}-USDT`;
            document.getElementById('strategy-coin').appendChild(option);
        }

        // 获取真实行情+自动判断交易信号
        async function fetchCoinPrice(coinCode, card) {
            try {
                const coinId = card ? card.dataset.id : coinIdMap[coinCode];
                const apiUrl = `https://api.coingecko.com/api/v3/simple/price?ids=${coinId}&vs_currencies=usd&include_24hr_change=true`;
                const response = await fetch(apiUrl);
                const data = await response.json();
                
                if (data[coinId]) {
                    const price = data[coinId].usd.toFixed(2);
                    const change = data[coinId].usd_24h_change.toFixed(2);
                    const signal = getSignal(parseFloat(change));

                    // 更新卡片数据
                    if (card) {
                        card.querySelector('.real-price').textContent = price;
                        card.querySelector('.real-change').textContent = change;
                        card.querySelector('.price-change').className = `price-change ${change >= 0 ? 'rise' : 'fall'}`;
                        // 更新信号样式
                        card.className = `coin-card ${signal.type}`;
                        // 更新欧易下单参数
                        const tpPrice = (parseFloat(price) * 1.03).toFixed(2);
                        const slPrice = (parseFloat(price) * 0.98).toFixed(2);
                        card.querySelector('.okx-order-params span').textContent = signal.text;
                        card.querySelectorAll('.okx-order-params span')[1].textContent = tpPrice;
                        card.querySelectorAll('.okx-order-params span')[2].textContent = slPrice;
                    } else {
                        document.querySelectorAll(`.coin-card[data-coin="${coinCode}"]`).forEach(item => {
                            item.querySelector('.real-price').textContent = price;
                            item.querySelector('.real-change').textContent = change;
                            item.querySelector('.price-change').className = `price-change ${change >= 0 ? 'rise' : 'fall'}`;
                            item.className = `coin-card ${signal.type}`;
                        });
                    }

                    // 更新全局信号大字报
                    updateGlobalSignal();
                    // 更新人话版AI解读
                    updateAIAnalysis(coinCode, price, change, signal.text);
                }
            } catch (error) {
                console.log(`获取${coinCode}行情失败，用模拟数据`, error);
                const mockPrice = (Math.random() * 1000 + 100).toFixed(2);
                const mockChange = (Math.random() * 4 - 2).toFixed(2);
                const signal = getSignal(parseFloat(mockChange));
                if (card) {
                    card.querySelector('.real-price').textContent = mockPrice;
                    card.querySelector('.real-change').textContent = mockChange;
                    card.querySelector('.price-change').className = `price-change ${mockChange >= 0 ? 'rise' : 'fall'}`;
                    card.className = `coin-card ${signal.type}`;
                }
            }
        }

        // 更新全局信号大字报
        function updateGlobalSignal() {
            const btcChange = parseFloat(document.querySelector('.coin-card[data-coin="BTC"] .real-change').textContent) || 0;
            const ethChange = parseFloat(document.querySelector('.coin-card[data-coin="ETH"] .real-change').textContent) || 0;
            const avgChange = (btcChange + ethChange) / 2;
            const signal = getSignal(avgChange);
            const globalSignal = document.getElementById('global-signal');
            globalSignal.className = `signal-banner ${signal.type}`;
            globalSignal.textContent = `大盘信号：${signal.text}`;
        }

        // 更新人话版AI解读
        function updateAIAnalysis(coinCode, price, change, signal) {
            const aiContent = document.getElementById('ai-analysis');
            const changeNum = parseFloat(change);
            let desc = '';
            if (changeNum > 2) desc = `涨了${change}%，多头很强，赶紧跟车开多！`;
            else if (changeNum < -2) desc = `跌了${change}%，空头很强，赶紧开空！`;
            else desc = `涨跌不大，震荡行情，别下单！`;
            
            const existing = aiContent.textContent.includes(`【${coinCode}】`) 
                ? aiContent.textContent.split(`【${coinCode}】`)[0] 
                : aiContent.textContent.split('\n\n')[0] + '\n';
            
            aiContent.textContent = `${existing}【${coinCode}】价格${price} USDT，${desc}
信号：${signal} | 操作：${signal === '观望' ? '别碰' : '去欧易抄参数下单'}
\n<strong>小白提示：</strong>只做「强势开多」「强势开空」的币种，观望的别浪费钱！`;
        }

        // 初始化+30秒自动刷新
        window.onload = function() {
            ['BTC', 'ETH', 'SOL'].forEach(coin => {
                fetchCoinPrice(coin);
            });
            setInterval(() => {
                document.querySelectorAll('.coin-card').forEach(card => {
                    const coin = card.dataset.coin;
                    fetchCoinPrice(coin, card);
                });
            }, 30000);
        }

        // 快捷键监听（简化）
        document.addEventListener('keydown', function(e) {
            switch(e.key) {
                case 'F1': alert('切换K线周期：15m→5m→1m→1h（小白看15m就行）'); break;
                case 'F2': if (confirm('清空预警线？')) alert('预警线已清空'); break;
                case 'F3': document.getElementById('risk-capital').focus(); break;
                case 'F4': document.querySelectorAll('.indicator-btn').forEach(btn => toggleIndicator(btn)); break;
            }
        });
    </script>
</body>
</html>