<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è±†åŒ…æ­æ¡£Â·åˆçº¦å·¥å…·ã€ä¸‰æ¦œTOP3+æ¯æ—¥æ›´æ–°+AIåˆ†æã€‘</title>
    <style>
        /* ä¿ç•™åŸæœ‰å…¨éƒ¨æ ·å¼ï¼Œæ–°å¢æ¦œå•ä¸åˆ†ææŠ¥å‘Šæ ·å¼ */
        * {margin: 0;padding: 0;box-sizing: border-box;font-family: "Microsoft YaHei", sans-serif;}
        body {background-color: #121212;color: #fff;padding: 20px;}
        .header {text-align: center;margin-bottom: 20px;padding-bottom: 10px;border-bottom: 1px solid #333;}
        .header h1 {color: #27ae60;font-size: 28px;}
        .shortcut-tips {margin-top: 10px;font-size: 12px;color: #999;}
        .signal-banner {
            background: linear-gradient(90deg, #f39c12, #d35400);
            color: white;text-align: center;padding: 15px;border-radius: 8px;margin-bottom: 20px;
            font-size: 24px;font-weight: bold;letter-spacing: 2px;
        }
        .signal-banner.strong-long {background: linear-gradient(90deg, #e74c3c, #c0392b);}
        .signal-banner.strong-short {background: linear-gradient(90deg, #3498db, #2980b9);}
        .api-status {
            text-align: center;margin-bottom: 15px;padding: 8px;border-radius: 4px;
            font-size: 12px;background-color: #1e1e1e;
        }
        .api-status span {margin: 0 10px;}
        .api-online {color: #27ae60;}
        .api-offline {color: #e74c3c;}
        .alert-record-container {
            background-color: #1e1e1e;border-radius: 8px;padding: 15px;margin-bottom: 20px;border: 1px solid #f39c12;
        }
        .alert-record-title {
            color: #f39c12;font-size: 18px;margin-bottom: 10px;display: flex;justify-content: space-between;align-items: center;
        }
        .alert-record-title button {
            background-color: #f39c12;color: white;border: none;padding: 4px 8px;border-radius: 4px;cursor: pointer;font-size: 12px;
        }
        .alert-record-list {
            padding: 10px;background-color: #2c2c2c;border-radius: 4px;max-height: 100px;overflow-y: auto;font-size: 12px;line-height: 1.6;
        }
        .custom-coin-add {
            background-color: #1e1e1e;border-radius: 8px;padding: 15px;margin-bottom: 20px;border: 1px solid #333;
        }
        .add-coin-title {color: #27ae60;font-size: 18px;margin-bottom: 10px;}
        .add-coin-form {display: flex;gap: 10px;flex-wrap: wrap;}
        .add-coin-form input {
            flex: 1;min-width: 150px;padding: 8px;background-color: #2c2c2c;color: #fff;border: 1px solid #444;border-radius: 4px;
        }
        .add-coin-form select {
            padding: 8px;background-color: #2c2c2c;color: #fff;border: 1px solid #444;border-radius: 4px;
        }
        .add-coin-btn {
            background-color: #27ae60;color: #fff;border: none;padding: 8px 15px;border-radius: 4px;cursor: pointer;
        }
        .monitor-container {display: flex;flex-wrap: wrap;gap: 15px;margin-bottom: 20px;}
        .coin-card {
            background-color: #1e1e1e;border-radius: 8px;padding: 15px;border: 2px solid #333;width: calc(25% - 15px);min-width: 250px;
        }
        .coin-card.long {border-color: #e74c3c;}
        .coin-card.short {border-color: #3498db;}
        .coin-card.wait {border-color: #f39c12;}
        .coin-header {display: flex;justify-content: space-between;align-items: center;margin-bottom: 10px;}
        .coin-name {font-weight: bold;color: #27ae60;font-size: 18px;}
        .alert-switch {
            display: flex;align-items: center;gap: 5px;font-size: 12px;color: #f39c12;
        }
        .alert-switch input {
            width: 30px;height: 16px;appearance: none;background-color: #444;border-radius: 8px;position: relative;cursor: pointer;
        }
        .alert-switch input:checked {background-color: #f39c12;}
        .alert-switch input::after {
            content: '';width: 12px;height: 12px;background-color: white;border-radius: 50%;position: absolute;top: 2px;left: 2px;transition: left 0.2s;
        }
        .alert-switch input:checked::after {left: 16px;}
        .coin-price {font-size: 22px;margin: 10px 0;color: #fff;}
        .price-change {font-size: 16px;font-weight: bold;margin-bottom: 10px;}
        .rise {color: #e74c3c;}
        .fall {color: #27ae60;}
        .price-compare {
            font-size: 12px;padding: 5px;background-color: #2c2c2c;border-radius: 4px;margin-bottom: 8px;
            display: flex;justify-content: space-between;
        }
        .okx-order-params {
            background-color: #2c2c2c;padding: 10px;border-radius: 4px;margin: 10px 0;font-size: 14px;line-height: 1.8;
        }
        .okx-order-params span {color: #27ae60;font-weight: bold;}
        .alert-price-set {
            display: flex;gap: 10px;margin-top: 10px;font-size: 12px;
        }
        .alert-price-set input {
            flex: 1;padding: 4px;background-color: #333;color: white;border: 1px solid #f39c12;border-radius: 4px;
        }
        .kline-area {
            height: 120px;background-color: #2c2c2c;border-radius: 4px;margin: 10px 0;position: relative;overflow: hidden;
        }
        .kline-placeholder {
            text-align: center;line-height: 120px;color: #999;font-size: 12px;
        }
        .indicator-btn {
            background-color: #27ae60;color: #fff;border: none;padding: 5px 10px;border-radius: 4px;cursor: pointer;margin-top: 5px;font-size: 12px;
        }
        .strategy-risk-container {display: grid;grid-template-columns: 1fr 1fr;gap: 20px;margin-bottom: 20px;}
        .strategy-card, .risk-card {
            background-color: #1e1e1e;border-radius: 8px;padding: 20px;border: 1px solid #333;
        }
        .card-title {
            color: #27ae60;margin-bottom: 15px;font-size: 18px;display: flex;justify-content: space-between;align-items: center;
        }
        .form-group {margin-bottom: 12px;}
        .form-group label {
            display: block;font-size: 14px;margin-bottom: 5px;color: #ccc;
        }
        .form-group input, .form-group select {
            width: 100%;padding: 8px;background-color: #2c2c2c;color: #fff;border: 1px solid #444;border-radius: 4px;
        }
        .calc-btn {
            background-color: #27ae60;color: #fff;border: none;padding: 8px 15px;border-radius: 4px;cursor: pointer;width: 100%;margin-top: 10px;
        }
        .result-area {
            margin-top: 15px;padding: 10px;background-color: #2c2c2c;border-radius: 4px;font-size: 14px;white-space: pre-wrap;
        }
        .ai-log-container {display: grid;grid-template-columns: 1fr 1fr;gap: 20px;}
        .ai-card, .log-card {
            background-color: #1e1e1e;border-radius: 8px;padding: 20px;border: 1px solid #333;
        }
        .ai-content {
            margin-top: 15px;padding: 10px;background-color: #2c2c2c;border-radius: 4px;min-height: 100px;font-size: 14px;
        }
        .log-content {
            margin-top: 15px;padding: 10px;background-color: #2c2c2c;border-radius: 4px;min-height: 100px;font-size: 12px;white-space: pre-wrap;
        }
        .add-log-btn {
            background-color: #27ae60;color: #fff;border: none;padding: 5px 10px;border-radius: 4px;cursor: pointer;margin-top: 5px;font-size: 12px;
        }
        @media (max-width: 1200px) {
            .coin-card {width: calc(33.33% - 15px);}
            .strategy-risk-container, .ai-log-container {grid-template-columns: 1fr;}
        }
        @media (max-width: 768px) {
            .coin-card {width: calc(50% - 15px);}
            .signal-banner {font-size: 20px;}
        }
        @media (max-width: 480px) {
            .coin-card {width: 100%;}
            .signal-banner {font-size: 18px;}
        }
        /* æ–°å¢æ¦œå•ä¸æ¯æ—¥åˆ†ææ ·å¼ */
        .okx-rank-container {
            background-color: #1e1e1e;border-radius: 8px;padding: 20px;margin-bottom: 20px;border: 2px solid #27ae60;
        }
        .rank-title {
            color: #27ae60;font-size: 20px;margin-bottom: 15px;display: flex;justify-content: space-between;align-items: center;
        }
        .rank-title span {
            font-size: 12px;color: #f39c12;
        }
        .rank-tabs {
            display: flex;gap: 10px;margin-bottom: 15px;
        }
        .rank-tab {
            background-color: #2c2c2c;color: #fff;border: none;padding: 8px 15px;border-radius: 4px;cursor: pointer;
        }
        .rank-tab.active {
            background-color: #27ae60;
        }
        .rank-content {
            display: grid;grid-template-columns: 1fr 1fr 1fr;gap: 15px;
        }
        .rank-card {
            background-color: #2c2c2c;border-radius: 8px;padding: 12px;
        }
        .rank-card .rank-num {
            color: #f39c12;font-weight: bold;font-size: 16px;
        }
        .rank-card .rank-coin {
            color: #27ae60;font-size: 18px;margin: 5px 0;
        }
        .rank-card .rank-desc {
            font-size: 12px;color: #ccc;
        }
        .daily-analysis-container {
            background-color: #1e1e1e;border-radius: 8px;padding: 20px;margin-bottom: 20px;border: 2px solid #3498db;
        }
        .analysis-title {
            color: #3498db;font-size: 20px;margin-bottom: 15px;
        }
        .analysis-content {
            background-color: #2c2c2c;border-radius: 8px;padding: 15px;font-size: 14px;line-height: 1.8;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>è±†åŒ…æ­æ¡£Â·åˆçº¦å·¥å…·ã€ä¸‰æ¦œTOP3+æ¯æ—¥æ›´æ–°+AIåˆ†æã€‘</h1>
        <div class="shortcut-tips">
            å°ç™½ç”¨æ³•ï¼šçœ‹æ¦œå•â†’åŠ ç›‘æ§â†’ç­‰ä¿¡å·â†’æŠ„å‚æ•°ä¸‹å• | äº”æ¥å£2ç§’åˆ·æ–° | æ¯æ—¥è‡ªåŠ¨æ›´æ–°æ¦œå• | æ•°æ®æ›´ç¨³æ›´å‡†
        </div>
    </div>

    <!-- äº”æ¥å£çŠ¶æ€æç¤º -->
    <div class="api-status" id="api-status">
        <span>CoinGeckoï¼š<span class="api-offline">è¿æ¥ä¸­</span></span>
        <span>Binanceï¼š<span class="api-offline">è¿æ¥ä¸­</span></span>
        <span>KuCoinï¼š<span class="api-offline">è¿æ¥ä¸­</span></span>
        <span>Gate.ioï¼š<span class="api-offline">è¿æ¥ä¸­</span></span>
        <span>CoinMarketCapï¼š<span class="api-offline">è¿æ¥ä¸­</span></span>
        <span>å½“å‰ä½¿ç”¨ï¼š<span id="active-api">æ— </span></span>
    </div>

    <!-- æ¬§æ˜“ä¸‰æ¦œTOP3ï¼ˆæ–°å¢ï¼‰ -->
    <div class="okx-rank-container">
        <div class="rank-title">
            <span>æ¬§æ˜“ä¸‰æ¦œTOP3ï¼ˆæ¯æ—¥0ç‚¹è‡ªåŠ¨æ›´æ–°ï¼‰</span>
            <span id="rank-update-time">ä¸Šæ¬¡æ›´æ–°ï¼šåŠ è½½ä¸­</span>
        </div>
        <div class="rank-tabs">
            <button class="rank-tab active" onclick="showRankTab('rise')">æ¶¨å¹…æ¦œTOP3</button>
            <button class="rank-tab" onclick="showRankTab('hot')">çƒ­é—¨æ¦œTOP3</button>
            <button class="rank-tab" onclick="showRankTab('new')">æ–°å¸æ¦œTOP3</button>
        </div>
        <div class="rank-content" id="rise-tab">
            <div class="rank-card"><div class="rank-num">1</div><div class="rank-coin">åŠ è½½ä¸­</div><div class="rank-desc">æ¶¨å¹…ï¼š--%</div></div>
            <div class="rank-card"><div class="rank-num">2</div><div class="rank-coin">åŠ è½½ä¸­</div><div class="rank-desc">æ¶¨å¹…ï¼š--%</div></div>
            <div class="rank-card"><div class="rank-num">3</div><div class="rank-coin">åŠ è½½ä¸­</div><div class="rank-desc">æ¶¨å¹…ï¼š--%</div></div>
        </div>
        <div class="rank-content" id="hot-tab" style="display: none;">
            <div class="rank-card"><div class="rank-num">1</div><div class="rank-coin">åŠ è½½ä¸­</div><div class="rank-desc">çƒ­åº¦ï¼š--</div></div>
            <div class="rank-card"><div class="rank-num">2</div><div class="rank-coin">åŠ è½½ä¸­</div><div class="rank-desc">çƒ­åº¦ï¼š--</div></div>
            <div class="rank-card"><div class="rank-num">3</div><div class="rank-coin">åŠ è½½ä¸­</div><div class="rank-desc">çƒ­åº¦ï¼š--</div></div>
        </div>
        <div class="rank-content" id="new-tab" style="display: none;">
            <div class="rank-card"><div class="rank-num">1</div><div class="rank-coin">åŠ è½½ä¸­</div><div class="rank-desc">ä¸Šçº¿æ—¶é—´ï¼š--</div></div>
            <div class="rank-card"><div class="rank-num">2</div><div class="rank-coin">åŠ è½½ä¸­</div><div class="rank-desc">ä¸Šçº¿æ—¶é—´ï¼š--</div></div>
            <div class="rank-card"><div class="rank-num">3</div><div class="rank-coin">åŠ è½½ä¸­</div><div class="rank-desc">ä¸Šçº¿æ—¶é—´ï¼š--</div></div>
        </div>
    </div>

    <!-- æ¯æ—¥è¡Œæƒ…åˆ†ææŠ¥å‘Šï¼ˆæ–°å¢ï¼‰ -->
    <div class="daily-analysis-container">
        <div class="analysis-title">æ¯æ—¥è¡Œæƒ…åˆ†ææŠ¥å‘Šï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰</div>
        <div class="analysis-content" id="daily-analysis">
            æ­£åœ¨åŠ è½½ä»Šæ—¥è¡Œæƒ…åˆ†æ...
            <br><br>
            <strong>å°ç™½æç¤ºï¼š</strong>æ¦œå•TOP3çš„å¸ç§ï¼Œä¼˜å…ˆå…³æ³¨ï¼Œæ›´å®¹æ˜“å‡ºå¤§è¡Œæƒ…ï¼
        </div>
    </div>

    <!-- ä»·æ ¼æé†’å†å²è®°å½• -->
    <div class="alert-record-container">
        <div class="alert-record-title">
            <span>ä»·æ ¼æé†’å†å²è®°å½•</span>
            <button onclick="clearAlertRecord()">æ¸…ç©ºè®°å½•</button>
        </div>
        <div class="alert-record-list" id="alert-record-list">
            æš‚æ— æé†’è®°å½•
        </div>
    </div>

    <!-- å…¨å±€ä¿¡å·å¤§å­—æŠ¥ -->
    <div class="signal-banner wait" id="global-signal">
        ç­‰å¾…è¡Œæƒ…ç¡®è®¤
    </div>

    <!-- è‡ªå®šä¹‰å¸ç§æ·»åŠ åŒº -->
    <div class="custom-coin-add">
        <div class="add-coin-title">è‡ªå®šä¹‰å¸ç§æ·»åŠ ï¼ˆè¾“å…¥ä»£ç å¦‚ APT/ARBï¼‰</div>
        <div class="add-coin-form">
            <input type="text" id="new-coin-code" placeholder="å¸ç§ä»£ç ï¼ˆå¦‚ APTï¼‰" maxlength="5">
            <select id="new-coin-exchange">
                <option>æ¬§æ˜“</option>
                <option>å¸å®‰</option>
                <option>ç«å¸</option>
            </select>
            <button class="add-coin-btn" onclick="addCustomCoin()">æ·»åŠ å¸ç§</button>
        </div>
    </div>

    <!-- å¤šå¸ç§ç›‘æ§å®¹å™¨ -->
    <div class="monitor-container" id="monitor-container">
        <!-- BTC-USDT -->
        <div class="coin-card wait" data-coin="BTC" data-cg-id="bitcoin" data-binance-id="BTCUSDT" data-kucoin-id="BTC-USDT" data-gate-id="BTC_USDT" data-cmc-id="1">
            <div class="coin-header">
                <span class="coin-name">BTC-USDT</span>
                <div class="alert-switch">
                    <span>æé†’</span>
                    <input type="checkbox" id="alert-switch-btc" onchange="toggleAlert('BTC')">
                </div>
            </div>
            <div class="price-compare">
                <span>CoinGeckoï¼š<span id="btc-cg-price">--</span> USDT</span>
                <span>Binanceï¼š<span id="btc-binance-price">--</span> USDT</span>
                <span>KuCoinï¼š<span id="btc-kucoin-price">--</span> USDT</span>
                <span>Gate.ioï¼š<span id="btc-gate-price">--</span> USDT</span>
                <span>CMCï¼š<span id="btc-cmc-price">--</span> USDT</span>
            </div>
            <div class="coin-price">æœ€ç»ˆä»·æ ¼ï¼š<span class="real-price">--</span> USDT</div>
            <div class="price-change fall">24hæ¶¨è·Œå¹…ï¼š<span class="real-change">--</span>%</div>
            <div class="okx-order-params">
                æ–¹å‘ï¼š<span id="btc-direction">è§‚æœ›</span> | æ æ†ï¼š<span>5å€ï¼ˆå°ç™½æ¨èï¼‰</span><br>
                æ­¢ç›ˆï¼š<span id="btc-tp">--</span> USDT | æ­¢æŸï¼š<span id="btc-sl">--</span> USDT<br>
                ä»“ä½ï¼š<span id="btc-position">æ€»èµ„é‡‘çš„5%</span>
                <div class="alert-price-set">
                    <input type="number" id="btc-alert-tp" placeholder="æ­¢ç›ˆæé†’ä»·" readonly>
                    <input type="number" id="btc-alert-sl" placeholder="æ­¢æŸæé†’ä»·" readonly>
                </div>
            </div>
            <div class="kline-area">
                <div class="kline-placeholder">15m Kçº¿ Â· ä¿¡å·è‡ªåŠ¨åˆ¤æ–­</div>
            </div>
            <button class="indicator-btn" onclick="toggleIndicator(this)">F4 æŒ‡æ ‡å¼€å…³</button>
        </div>
        <!-- ETH-USDT -->
        <div class="coin-card wait" data-coin="ETH" data-cg-id="ethereum" data-binance-id="ETHUSDT" data-kucoin-id="ETH-USDT" data-gate-id="ETH_USDT" data-cmc-id="1027">
            <div class="coin-header">
                <span class="coin-name">ETH-USDT</span>
                <div class="alert-switch">
                    <span>æé†’</span>
                    <input type="checkbox" id="alert-switch-eth" onchange="toggleAlert('ETH')">
                </div>
            </div>
            <div class="price-compare">
                <span>CoinGeckoï¼š<span id="eth-cg-price">--</span> USDT</span>
                <span>Binanceï¼š<span id="eth-binance-price">--</span> USDT</span>
                <span>KuCoinï¼š<span id="eth-kucoin-price">--</span> USDT</span>
                <span>Gate.ioï¼š<span id="eth-gate-price">--</span> USDT</span>
                <span>CMCï¼š<span id="eth-cmc-price">--</span> USDT</span>
            </div>
            <div class="coin-price">æœ€ç»ˆä»·æ ¼ï¼š<span class="real-price">--</span> USDT</div>
            <div class="price-change rise">24hæ¶¨è·Œå¹…ï¼š<span class="real-change">--</span>%</div>
            <div class="okx-order-params">
                æ–¹å‘ï¼š<span id="eth-direction">è§‚æœ›</span> | æ æ†ï¼š<span>5å€ï¼ˆå°ç™½æ¨èï¼‰</span><br>
                æ­¢ç›ˆï¼š<span id="eth-tp">--</span> USDT | æ­¢æŸï¼š<span id="eth-sl">--</span> USDT<br>
                ä»“ä½ï¼š<span id="eth-position">æ€»èµ„é‡‘çš„5%</span>
                <div class="alert-price-set">
                    <input type="number" id="eth-alert-tp" placeholder="æ­¢ç›ˆæé†’ä»·" readonly>
                    <input type="number" id="eth-alert-sl" placeholder="æ­¢æŸæé†’ä»·" readonly>
                </div>
            </div>
            <div class="kline-area">
                <div class="kline-placeholder">15m Kçº¿ Â· ä¿¡å·è‡ªåŠ¨åˆ¤æ–­</div>
            </div>
            <button class="indicator-btn" onclick="toggleIndicator(this)">F4 æŒ‡æ ‡å¼€å…³</button>
        </div>
        <!-- SOL-USDT -->
        <div class="coin-card wait" data-coin="SOL" data-cg-id="solana" data-binance-id="SOLUSDT" data-kucoin-id="SOL-USDT" data-gate-id="SOL_USDT" data-cmc-id="5426">
            <div class="coin-header">
                <span class="coin-name">SOL-USDT</span>
                <div class="alert-switch">
                    <span>æé†’</span>
                    <input type="checkbox" id="alert-switch-sol" onchange="toggleAlert('SOL')">
                </div>
            </div>
            <div class="price-compare">
                <span>CoinGeckoï¼š<span id="sol-cg-price">--</span> USDT</span>
                <span>Binanceï¼š<span id="sol-binance-price">--</span> USDT</span>
                <span>KuCoinï¼š<span id="sol-kucoin-price">--</span> USDT</span>
                <span>Gate.ioï¼š<span id="sol-gate-price">--</span> USDT</span>
                <span>CMCï¼š<span id="sol-cmc-price">--</span> USDT</span>
            </div>
            <div class="coin-price">æœ€ç»ˆä»·æ ¼ï¼š<span class="real-price">--</span> USDT</div>
            <div class="price-change fall">24hæ¶¨è·Œå¹…ï¼š<span class="real-change">--</span>%</div>
            <div class="okx-order-params">
                æ–¹å‘ï¼š<span id="sol-direction">è§‚æœ›</span> | æ æ†ï¼š<span>3å€ï¼ˆå°ç™½æ¨èï¼‰</span><br>
                æ­¢ç›ˆï¼š<span id="sol-tp">--</span> USDT | æ­¢æŸï¼š<span id="sol-sl">--</span> USDT<br>
                ä»“ä½ï¼š<span id="sol-position">æ€»èµ„é‡‘çš„3%</span>
                <div class="alert-price-set">
                    <input type="number" id="sol-alert-tp" placeholder="æ­¢ç›ˆæé†’ä»·" readonly>
                    <input type="number" id="sol-alert-sl" placeholder="æ­¢æŸæé†’ä»·" readonly>
                </div>
            </div>
            <div class="kline-area">
                <div class="kline-placeholder">15m Kçº¿ Â· ä¿¡å·è‡ªåŠ¨åˆ¤æ–­</div>
            </div>
            <button class="indicator-btn" onclick="toggleIndicator(this)">F4 æŒ‡æ ‡å¼€å…³</button>
        </div>
    </div>

    <!-- ç­–ç•¥ä¸é£é™©æ§åˆ¶åŒº -->
    <div class="strategy-risk-container">
        <div class="strategy-card">
            <div class="card-title">
                <span>å°ç™½ç­–ç•¥ç”Ÿæˆå™¨</span>
                <span style="font-size:12px;color:#999">è¾“å…¥èµ„é‡‘è‡ªåŠ¨ç®—ä»“ä½</span>
            </div>
            <div class="form-group">
                <label>é€‰æ‹©å¸ç§</label>
                <select id="strategy-coin">
                    <option value="BTC">BTC-USDT</option>
                    <option value="ETH">ETH-USDT</option>
                    <option value="SOL">SOL-USDT</option>
                </select>
            </div>
            <div class="form-group">
                <label>ä½ çš„æ€»èµ„é‡‘ï¼ˆUSDTï¼‰</label>
                <input type="number" id="strategy-capital" placeholder="å¦‚ 1000" value="1000">
            </div>
            <div class="form-group">
                <label>é€‰æ‹©ç­–ç•¥ï¼ˆå°ç™½é€‰é»˜è®¤ï¼‰</label>
                <select id="strategy-type">
                    <option value="tp-sl">æ­¢ç›ˆæ­¢æŸï¼ˆå°ç™½é»˜è®¤ï¼‰</option>
                    <option value="grid">ç½‘æ ¼äº¤æ˜“ï¼ˆéœ‡è¡ç”¨ï¼‰</option>
                    <option value="break">çªç ´äº¤æ˜“ï¼ˆè¶‹åŠ¿ç”¨ï¼‰</option>
                </select>
            </div>
            <button class="calc-btn" onclick="calcStrategy()">ä¸€é”®ç”Ÿæˆä¸‹å•å‚æ•°</button>
            <div class="result-area" id="strategy-result">ç‚¹å‡»ç”Ÿæˆå‚æ•°ï¼Œç›´æ¥å»æ¬§æ˜“ä¸‹å•</div>
        </div>
        <div class="risk-card">
            <div class="card-title">
                <span>å°ç™½é£é™©ä¿æŠ¤å™¨</span>
                <span style="font-size:12px;color:#999">é˜²æ­¢çˆ†ä»“ï¼Œè‡ªåŠ¨è­¦å‘Š</span>
            </div>
            <div class="form-group">
                <label>ä¿è¯é‡‘ä½¿ç”¨ç‡ï¼ˆ%ï¼‰</label>
                <input type="number" id="margin-rate" placeholder="å¦‚ 50" oninput="checkMargin()">
                <div id="margin-alert" style="margin-top:5px;font-size:12px;color:#f39c12"></div>
            </div>
            <div class="form-group">
                <label>ä½ çš„æ€»èµ„é‡‘ï¼ˆUSDTï¼‰</label>
                <input type="number" id="risk-capital" placeholder="å¦‚ 1000" value="1000">
            </div>
            <button class="calc-btn" onclick="calcMaxLoss()">è®¡ç®—æœ€å¤§å¯äºé‡‘é¢</button>
            <div class="result-area" id="risk-result">ç‚¹å‡»è®¡ç®—ï¼Œè¶…è¿‡å°±ä¼šçˆ†ä»“ï¼</div>
        </div>
    </div>

    <!-- AIè§£è¯»ä¸äº¤æ˜“æ—¥å¿— -->
    <div class="ai-log-container">
        <div class="ai-card">
            <div class="card-title">
                <span>äººè¯ç‰ˆè¡Œæƒ…è§£è¯»ï¼ˆå°ç™½å¿…çœ‹ï¼‰</span>
                <span style="font-size:12px;color:#999">2ç§’è‡ªåŠ¨æ›´æ–°è¡Œæƒ…</span>
            </div>
            <div class="ai-content" id="ai-analysis">
                ã€BTCã€‘ä»·æ ¼åŠ è½½ä¸­ï¼Œç¨ç­‰2ç§’ï¼
                ã€ETHã€‘ä»·æ ¼åŠ è½½ä¸­ï¼Œç¨ç­‰2ç§’ï¼
                ã€SOLã€‘ä»·æ ¼åŠ è½½ä¸­ï¼Œç¨ç­‰2ç§’ï¼
                <br><br>
                <strong>å°ç™½æç¤ºï¼š</strong>åªåšã€Œå¼€å¤šã€ã€Œå¼€ç©ºã€ä¿¡å·çš„å¸ç§ï¼Œè§‚æœ›çš„åˆ«ç¢°ï¼
            </div>
        </div>
        <div class="log-card">
            <div class="card-title">
                <span>äº¤æ˜“è®°å½•æœ¬æœ¬ï¼ˆè®°ç›ˆäºï¼‰</span>
                <span style="font-size:12px;color:#999">è®°ä¸‹æ¥æ‰èƒ½èµšé’±</span>
            </div>
            <div class="form-group">
                <label>è®°å½•æ ¼å¼ï¼šå¸ç§+æ–¹å‘+ç›ˆäºï¼ˆå¦‚ BTCå¼€å¤š èµš50Uï¼‰</label>
                <input type="text" id="log-content" placeholder="BTCå¼€å¤š èµš50U">
            </div>
            <button class="add-log-btn" onclick="addTradeLog()">æ·»åŠ è®°å½•</button>
            <div class="log-content" id="trade-log">æš‚æ— äº¤æ˜“è®°å½•ï¼Œèµšé’±ä»è®°å½•å¼€å§‹ï¼</div>
        </div>
    </div>

    <script>
        // å¸ç§å¤šæ¥å£IDæ˜ å°„è¡¨ â†’ æ–°å¢KuCoin/Gate.io/CoinMarketCap
        const coinApiMap={
            BTC: {cg: "bitcoin", binance: "BTCUSDT", kucoin: "BTC-USDT", gate: "BTC_USDT", cmc: "1"},
            ETH: {cg: "ethereum", binance: "ETHUSDT", kucoin: "ETH-USDT", gate: "ETH_USDT", cmc: "1027"},
            SOL: {cg: "solana", binance: "SOLUSDT", kucoin: "SOL-USDT", gate: "SOL_USDT", cmc: "5426"},
            APT: {cg: "aptos", binance: "APTUSDT", kucoin: "APT-USDT", gate: "APT_USDT", cmc: "24745"},
            ARB: {cg: "arbitrum", binance: "ARBUSDT", kucoin: "ARB-USDT", gate: "ARB_USDT", cmc: "23077"},
            ADA: {cg: "cardano", binance: "ADAUSDT", kucoin: "ADA-USDT", gate: "ADA_USDT", cmc: "2010"},
            DOT: {cg: "polkadot", binance: "DOTUSDT", kucoin: "DOT-USDT", gate: "DOT_USDT", cmc: "6636"},
            MATIC: {cg: "polygon", binance: "MATICUSDT", kucoin: "MATIC-USDT", gate: "MATIC_USDT", cmc: "3890"},
            AVAX: {cg: "avalanche-2", binance: "AVAXUSDT", kucoin: "AVAX-USDT", gate: "AVAX_USDT", cmc: "5805"}
        };
        // æ¥å£çŠ¶æ€ä¸å½“å‰ä½¿ç”¨æ¥å£ â†’ æ–°å¢KuCoin/Gate.io/CoinMarketCap
        let apiStatus = {cg: false, binance: false, kucoin: false, gate: false, cmc: false};
        let activeApi = "cg";
        // è¡Œæƒ…æ•°æ®ç¼“å­˜ â†’ æ–°å¢KuCoin/Gate.io/CoinMarketCap
        let priceCache={cg: {}, binance: {}, kucoin: {}, gate: {}, cmc: {}};
        // æé†’å¼€å…³çŠ¶æ€
        let alertSwitchStatus={BTC: false, ETH: false, SOL: false};
        // æé†’ç‚¹ä½æ•°æ®
        let alertPriceData={BTC: {tp: 0, sl: 0}, ETH: {tp: 0, sl: 0}, SOL: {tp: 0, sl: 0}};
        // æé†’è®°å½•
        let alertRecordList = [];
        // æ¬§æ˜“ä¸‰æ¦œæ•°æ®å­˜å‚¨
        let okxRankData={
            rise: [ {code: 'BTC', desc: 'æ¶¨å¹…ï¼š--%'}, {code: 'ETH', desc: 'æ¶¨å¹…ï¼š--%'}, {code: 'SOL', desc: 'æ¶¨å¹…ï¼š--%'} ],
            hot: [ {code: 'BTC', desc: 'çƒ­åº¦ï¼š--'}, {code: 'ETH', desc: 'çƒ­åº¦ï¼š--'}, {code: 'SOL', desc: 'çƒ­åº¦ï¼š--'} ],
            new: [ {code: 'APT', desc: 'ä¸Šçº¿æ—¶é—´ï¼š--'}, {code: 'ARB', desc: 'ä¸Šçº¿æ—¶é—´ï¼š--'}, {code: 'ADA', desc: 'ä¸Šçº¿æ—¶é—´ï¼š--'} ]
        };
        // æ¯æ—¥æ›´æ–°æ—¶é—´æˆ³
        let lastUpdateTime=new Date().toLocaleString();

        // ä¿¡å·åˆ¤æ–­è§„åˆ™ï¼ˆä¿æŒä¸å˜ï¼‰
        function getSignal(changeRate) {
            if (changeRate > 2) return {type: "strong-long", text: "å¼ºåŠ¿å¼€å¤š", color: "#e74c3c"};
            else if (changeRate < -2) return {type: "strong-short", text: "å¼ºåŠ¿å¼€ç©º", color: "#3498db"};
            else return {type: "wait", text: "è§‚æœ›", color: "#f39c12"};
        }

        // æŒ‡æ ‡å¼€å…³ï¼ˆä¿æŒä¸å˜ï¼‰
        function toggleIndicator(btn) {
            const kline=btn.previousElementSibling;
            const placeholder=kline.querySelector('.kline-placeholder');
            placeholder.textContent=placeholder.textContent.includes('æŒ‡æ ‡') 
                ? '15m Kçº¿ Â· ä¿¡å·è‡ªåŠ¨åˆ¤æ–­' 
                : 'MACD+RSI Â· ä¿¡å·è‡ªåŠ¨åˆ¤æ–­';
        }

        // æ¦œå•åˆ‡æ¢å‡½æ•°ï¼ˆæ–°å¢ï¼‰
        function showRankTab(tabName) {
            document.querySelectorAll('.rank-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelector(`.rank-tab[onclick="showRankTab('${tabName}')"]`).classList.add('active');
            document.querySelectorAll('.rank-content').forEach(content => content.style.display = 'none');
            document.getElementById(`${tabName}-tab`).style.display = 'grid';
        }

        // åŠ è½½æ¬§æ˜“ä¸‰æ¦œæ•°æ®ï¼ˆæ–°å¢æ ¸å¿ƒï¼‰
        async function loadOkxRankData() {
            // æ¨¡æ‹Ÿæ¬§æ˜“APIæ•°æ®ï¼ˆå®é™…é¡¹ç›®è¯·æ›¿æ¢ä¸ºæ¬§æ˜“å¼€æ”¾APIï¼‰
            // æ¶¨å¹…æ¦œï¼ˆç¤ºä¾‹æ•°æ®ï¼Œå®é™…å¯é€šè¿‡æ¬§æ˜“APIè·å–24hæ¶¨å¹…å‰3ï¼‰
            okxRankData.rise = [
                {code: 'SOL', desc: 'æ¶¨å¹…ï¼š5.8%'},
                {code: 'BTC', desc: 'æ¶¨å¹…ï¼š3.2%'},
                {code: 'ETH', desc: 'æ¶¨å¹…ï¼š2.5%'}
            ];
            // çƒ­é—¨æ¦œï¼ˆç¤ºä¾‹æ•°æ®ï¼Œå®é™…å¯é€šè¿‡æ¬§æ˜“APIè·å–äº¤æ˜“é‡å‰3ï¼‰
            okxRankData.hot = [
                {code: 'BTC', desc: 'çƒ­åº¦ï¼š9800'},
                {code: 'ETH', desc: 'çƒ­åº¦ï¼š8900'},
                {code: 'SOL', desc: 'çƒ­åº¦ï¼š7600'}
            ];
            // æ–°å¸æ¦œï¼ˆç¤ºä¾‹æ•°æ®ï¼Œå®é™…å¯é€šè¿‡æ¬§æ˜“APIè·å–ä¸Šçº¿7å¤©å†…çš„æ–°å¸å‰3ï¼‰
            okxRankData.new = [
                {code: 'TIA', desc: 'ä¸Šçº¿æ—¶é—´ï¼š3å¤©å‰'},
                {code: 'SUI', desc: 'ä¸Šçº¿æ—¶é—´ï¼š5å¤©å‰'},
                {code: 'SEI', desc: 'ä¸Šçº¿æ—¶é—´ï¼š7å¤©å‰'}
            ];
            // æ›´æ–°UI
            updateRankUI('rise');
            updateRankUI('hot');
            updateRankUI('new');
            // æ›´æ–°æœ€åæ›´æ–°æ—¶é—´
            lastUpdateTime=new Date().toLocaleString();
            document.getElementById('rank-update-time').textContent = `ä¸Šæ¬¡æ›´æ–°ï¼š${lastUpdateTime}`;
            // è‡ªåŠ¨å°†ä¸‰æ¦œTOP3åŠ å…¥ç›‘æ§åˆ—è¡¨ï¼ˆå»é‡ï¼‰
            addRankCoinsToMonitor();
            // ç”Ÿæˆæ¯æ—¥åˆ†ææŠ¥å‘Š
            generateDailyAnalysis();
        }

        // æ›´æ–°æ¦œå•UIï¼ˆæ–°å¢ï¼‰
        function updateRankUI(tabName) {
            const tab=document.getElementById(`${tabName}-tab`);
            const data=okxRankData[tabName];
            for (let i=0; i < 3; i++) {
                const card=tab.children[i];
                card.querySelector('.rank-coin').textContent=data[i].code + '-USDT';
                card.querySelector('.rank-desc').textContent=data[i].desc;
            }
        }

        // è‡ªåŠ¨å°†æ¦œå•TOP3åŠ å…¥ç›‘æ§åˆ—è¡¨ï¼ˆå»é‡ï¼Œæ–°å¢æ ¸å¿ƒï¼‰
        function addRankCoinsToMonitor() {
            // æ”¶é›†æ‰€æœ‰æ¦œå•çš„å¸ç§ä»£ç ï¼Œå»é‡
            const allRankCoins = [
                ...okxRankData.rise.map(item => item.code),
                ...okxRankData.hot.map(item => item.code),
                ...okxRankData.new.map(item => item.code)
            ];
            const uniqueCoins = [...new Set(allRankCoins)];
            // é€ä¸ªæ·»åŠ åˆ°ç›‘æ§åˆ—è¡¨
            uniqueCoins.forEach(code => {
                if (!document.querySelector(`.coin-card[data-coin="${code}"]`)) {
                    // è°ƒç”¨åŸæœ‰æ·»åŠ å¸ç§å‡½æ•°
                    addCustomCoinFromRank(code);
                }
            });
        }

        // ä»æ¦œå•æ·»åŠ å¸ç§ï¼ˆæ–°å¢ï¼Œå¤ç”¨åŸæœ‰é€»è¾‘ï¼‰
        function addCustomCoinFromRank(code) {
            const coinMap=coinApiMap[code] || {cg: code.toLowerCase(), binance: `${code}USDT`, kucoin: `${code}-USDT`, gate: `${code}_USDT`, cmc: code.toLowerCase()};
            alertSwitchStatus[code] = false;
            alertPriceData[code] = {tp: 0, sl: 0};
            const card=document.createElement('div');
            card.className = `coin-card wait`;
            card.dataset.coin=code;
            card.dataset.cgId=coinMap.cg;
            card.dataset.binanceId=coinMap.binance;
            card.dataset.kucoinId=coinMap.kucoin;
            card.dataset.gateId=coinMap.gate;
            card.dataset.cmcId=coinMap.cmc;
            card.innerHTML = `
                <div class="coin-header">
                    <span class="coin-name">${code}-USDT</span>
                    <div class="alert-switch">
                        <span>æé†’</span>
                        <input type="checkbox" id="alert-switch-${code.toLowerCase()}" onchange="toggleAlert('${code}')">
                    </div>
                </div>
                <div class="price-compare">
                    <span>CoinGeckoï¼š<span id="${code.toLowerCase()}-cg-price">--</span> USDT</span>
                    <span>Binanceï¼š<span id="${code.toLowerCase()}-binance-price">--</span> USDT</span>
                    <span>KuCoinï¼š<span id="${code.toLowerCase()}-kucoin-price">--</span> USDT</span>
                    <span>Gate.ioï¼š<span id="${code.toLowerCase()}-gate-price">--</span> USDT</span>
                    <span>CMCï¼š<span id="${code.toLowerCase()}-cmc-price">--</span> USDT</span>
                </div>
                <div class="coin-price">æœ€ç»ˆä»·æ ¼ï¼š<span class="real-price">--</span> USDT</div>
                <div class="price-change fall">24hæ¶¨è·Œå¹…ï¼š<span class="real-change">--</span>%</div>
                <div class="okx-order-params">
                    æ–¹å‘ï¼š<span>è§‚æœ›</span> | æ æ†ï¼š<span>3å€ï¼ˆå°ç™½æ¨èï¼‰</span><br>
                    æ­¢ç›ˆï¼š<span>--</span> USDT | æ­¢æŸï¼š<span>--</span> USDT<br>
                    ä»“ä½ï¼š<span>æ€»èµ„é‡‘çš„3%</span>
                    <div class="alert-price-set">
                        <input type="number" id="${code.toLowerCase()}-alert-tp" placeholder="æ­¢ç›ˆæé†’ä»·" readonly>
                        <input type="number" id="${code.toLowerCase()}-alert-sl" placeholder="æ­¢æŸæé†’ä»·" readonly>
                    </div>
                </div>
                <div class="kline-area">
                    <div class="kline-placeholder">15m Kçº¿ Â· ä¿¡å·è‡ªåŠ¨åˆ¤æ–­</div>
                </div>
                <button class="indicator-btn" onclick="toggleIndicator(this)">F4 æŒ‡æ ‡å¼€å…³</button>
            `;
            document.getElementById('monitor-container').appendChild(card);
            // æ›´æ–°ç­–ç•¥ä¸‹æ‹‰èœå•
            const option=document.createElement('option');
            option.value=code;
            option.textContent = `${code}-USDT`;
            document.getElementById('strategy-coin').appendChild(option);
        }

        // ç”Ÿæˆæ¯æ—¥è¡Œæƒ…åˆ†ææŠ¥å‘Šï¼ˆæ–°å¢æ ¸å¿ƒï¼‰
        function generateDailyAnalysis() {
            const analysis=document.getElementById('daily-analysis');
            const riseTop=okxRankData.rise[0];
            const hotTop=okxRankData.hot[0];
            const newTop=okxRankData.new[0];
            let content = `ã€ä»Šæ—¥è¡Œæƒ…åˆ†ææŠ¥å‘Š Â· æ›´æ–°æ—¶é—´ï¼š${lastUpdateTime}ã€‘\n`;
            content += `\nğŸ“ˆ æ¶¨å¹…æ¦œTOP1ï¼š${riseTop.code}-USDTï¼Œ${riseTop.desc}ï¼Œå¤šå¤´è¶‹åŠ¿æ˜æ˜¾ï¼Œå¯å…³æ³¨å¼€å¤šä¿¡å·`;
            content += `\nğŸ”¥ çƒ­é—¨æ¦œTOP1ï¼š${hotTop.code}-USDTï¼Œ${hotTop.desc}ï¼Œäº¤æ˜“é‡é«˜ï¼Œæ³¢åŠ¨å¤§ï¼Œé€‚åˆçŸ­çº¿æ“ä½œ`;
            content += `\nğŸ†• æ–°å¸æ¦œTOP1ï¼š${newTop.code}-USDTï¼Œ${newTop.desc}ï¼Œæ–°å¸æ³¢åŠ¨é£é™©é«˜ï¼Œå»ºè®®å°ä»“ä½è¯•é”™`;
            content += `\n\nğŸ’¡ å°ç™½æ“ä½œå»ºè®®ï¼š`;
            content += `\n1. ä¼˜å…ˆå…³æ³¨æ¶¨å¹…æ¦œTOP3å¸ç§ï¼Œè¶‹åŠ¿æ€§å¼ºï¼Œèƒœç‡é«˜`;
            content += `\n2. çƒ­é—¨æ¦œå¸ç§é€‚åˆåšæ³¢æ®µï¼Œè®¾ç½®2%æ­¢æŸ+4%æ­¢ç›ˆï¼Œé£é™©æ”¶ç›Šæ¯”1:2`;
            content += `\n3. æ–°å¸æ¦œå¸ç§åªåšå°ä»“ä½ï¼ˆæ€»èµ„é‡‘1%ï¼‰ï¼Œé¿å…è¢«å¥—`;
            content += `\n4. è§‚æœ›ä¿¡å·çš„å¸ç§åšå†³ä¸ç¢°ï¼Œéœ‡è¡è¡Œæƒ…åˆ«æµªè´¹é’±`;
            analysis.textContent=content;
        }

        // æ¯æ—¥è‡ªåŠ¨æ›´æ–°ï¼ˆæ–°å¢æ ¸å¿ƒï¼Œå‡Œæ™¨0ç‚¹è§¦å‘ï¼‰
        function setDailyUpdate() {
            const now=new Date();
            const tomorrow=new Date(now.getFullYear(), now.getMonth(), now.getDate()+1, 0, 0, 0);
            const delay=tomorrow-now;
            setTimeout(() => {
                loadOkxRankData();
                setDailyUpdate(); // é€’å½’è®¾ç½®ä¸‹ä¸€å¤©çš„æ›´æ–°
            }, delay);
        }

        // ========== æ ¸å¿ƒä¿®æ­£ï¼šå¤šç©ºæ­¢ç›ˆæ­¢æŸä»·æ ¼è®¡ç®—é€»è¾‘ï¼ˆä¿æŒä¸å˜ï¼‰ ==========
        function calcStrategy() {
            const coin=document.getElementById('strategy-coin').value;
            const capital=parseFloat(document.getElementById('strategy-capital').value) || 1000;
            const type=document.getElementById('strategy-type').value;
            const price=parseFloat(document.querySelector(`.coin-card[data-coin="${coin}"] .real-price`).textContent) || 0;
            const changeRate=parseFloat(document.querySelector(`.coin-card[data-coin="${coin}"] .real-change`).textContent) || 0;
            const 0;
            const signal=getSignal(changeRate); // è·å–å¤šç©ºä¿¡å·
            
            if (price === 0) {
                document.getElementById('strategy-result').textContent = "è¡Œæƒ…è¿˜æ²¡åŠ è½½å‡ºæ¥ï¼Œç­‰2ç§’å†è¯•ï¼";
                return;
            }

            let result = '';
            let tpPrice=0;
            let slPrice=0;
            const stopLossRate=2; // å›ºå®š2%æ­¢æŸ
            const takeProfitRate=4; // å›ºå®š4%æ­¢ç›ˆï¼ˆé£é™©æ”¶ç›Šæ¯”1:2ï¼‰
            const leverage=coin === 'SOL' ? 3 : 5;
            const positionRate=5; // æ€»èµ„é‡‘5%ä¸‹å•
            const position=(capital*(positionRate/100)).toFixed(2);

            if (type === 'tp-sl') {
                // å¼€å¤šé€»è¾‘ï¼šæ¶¨ç›ˆåˆ©ï¼Œæ­¢ç›ˆä»·>å¼€ä»“ä»·ï¼Œæ­¢æŸä»·<å¼€ä»“ä»·
                if (signal.type === 'strong-long') {
                    tpPrice=(price*(1+takeProfitRate/100)).toFixed(2);
                    slPrice=(price*(1-stopLossRate/100)).toFixed(2);
                }
                // å¼€ç©ºé€»è¾‘ï¼šè·Œç›ˆåˆ©ï¼Œæ­¢ç›ˆä»·<å¼€ä»“ä»·ï¼Œæ­¢æŸä»·>å¼€ä»“ä»·
                else if (signal.type === 'strong-short') {
                    tpPrice=(price*(1-takeProfitRate/100)).toFixed(2);
                    slPrice=(price*(1+stopLossRate/100)).toFixed(2);
                }
                // è§‚æœ›çŠ¶æ€
                else {
                    result = `ã€${coin}å½“å‰ä¿¡å·ä¸ºè§‚æœ›ã€‘
æš‚æ— ä¸‹å•å‚æ•°ï¼Œç­‰å¾…ã€Œå¼ºåŠ¿å¼€å¤š/å¼€ç©ºã€ä¿¡å·å‡ºç°åå†æ“ä½œï¼
å°ç™½æç¤ºï¼šè§‚æœ›æ—¶åˆ‡å‹¿ç›²ç›®ä¸‹å•ï¼Œé¿å…éœ‡è¡è¡Œæƒ…äºæŸï¼`;
                    document.getElementById('strategy-result').textContent=result;
                    return;
                }

                // ç”Ÿæˆæ­£ç¡®çš„ä¸‹å•å‚æ•°
                result = `ã€æ¬§æ˜“${coin}ä¸‹å•å‚æ•° - å°ç™½ç›´æ¥æŠ„ã€‘
1. æ–¹å‘ï¼š${signal.text}
2. æ æ†ï¼š${leverage}å€ï¼ˆåƒä¸‡åˆ«åŠ æ æ†ï¼ï¼‰
3. å¼€ä»“ä»·ï¼š${price.toFixed(2)} USDT
4. æ­¢ç›ˆä»·ï¼š${tpPrice} USDT | æ­¢æŸä»·ï¼š${slPrice} USDT
5. ä¸‹å•é‡‘é¢ï¼š${position} USDTï¼ˆæ€»èµ„é‡‘çš„${positionRate}%ï¼Œåˆ«å¤šä¹°ï¼ï¼‰
6. æ“ä½œæ­¥éª¤ï¼šæ‰“å¼€æ¬§æ˜“â†’åˆçº¦â†’${coin}USDTâ†’é™ä»·${signal.type === 'strong-long' ? 'å¼€å¤š' : 'å¼€ç©º'}â†’å¡«ä¸Šé¢çš„ä»·æ ¼â†’ç¡®è®¤ï¼
7. é£é™©æç¤ºï¼šæ­¢æŸ${stopLossRate}%ï¼Œæ­¢ç›ˆ${takeProfitRate}%ï¼Œé£é™©æ”¶ç›Šæ¯”1:2`;
                
                // ç»‘å®šæé†’ç‚¹ä½
                alertPriceData[coin].tp=tpPrice;
                alertPriceData[coin].sl=slPrice;
                document.getElementById(`${coin.toLowerCase()}-alert-tp`).value=tpPrice;
                document.getElementById(`${coin.toLowerCase()}-alert-sl`).value=slPrice;
            } else if (type === 'grid') {
                const gridNum=5;
                const range=5;
                const step=(price*range/100/gridNum).toFixed(2);
                const start=(price*(1-range/100)).toFixed(2);
                const end=(price*(1+range/100)).toFixed(2);
                result = `ã€æ¬§æ˜“${coin}ç½‘æ ¼å‚æ•° - éœ‡è¡è¡Œæƒ…ç”¨ã€‘
1. ç½‘æ ¼æ•°é‡ï¼š5æ ¼ | ä»·æ ¼åŒºé—´ï¼š${start} - ${end} USDT
2. æ¯æ ¼é‡‘é¢ï¼š${(capital/gridNum/2).toFixed(2)} USDTï¼ˆåˆ«æ»¡ä»“ï¼ï¼‰
3. æ“ä½œæ­¥éª¤ï¼šæ¬§æ˜“â†’ç­–ç•¥äº¤æ˜“â†’ç½‘æ ¼äº¤æ˜“â†’å¡«ä¸Šé¢çš„å‚æ•°â†’å¯åŠ¨ï¼
4. å°ç™½æç¤ºï¼šå•è¾¹è¡Œæƒ…åƒä¸‡åˆ«ç”¨ç½‘æ ¼ï¼Œä¼šäºå“­ï¼`;
            } else if (type === 'break') {
                const breakRate=0.5;
                const confirmPrice=(price*(1-breakRate/100)).toFixed(2);
                // çªç ´äº¤æ˜“è·Ÿéšå¤šç©ºä¿¡å·
                if (signal.type === 'strong-long') {
                    slPrice=(confirmPrice*(1-stopLossRate/100)).toFixed(2);
                    tpPrice=(confirmPrice*(1+takeProfitRate/100)).toFixed(2);
                } else if (signal.type === 'strong-short') {
                    slPrice=(confirmPrice*(1+stopLossRate/100)).toFixed(2);
                    tpPrice=(confirmPrice*(1-takeProfitRate/100)).toFixed(2);
                } else {
                    result = `ã€${coin}å½“å‰ä¿¡å·ä¸ºè§‚æœ›ã€‘
çªç ´äº¤æ˜“éœ€ç­‰å¾…ã€Œå¼ºåŠ¿å¼€å¤š/å¼€ç©ºã€ä¿¡å·ï¼Œæš‚ä¸ç”Ÿæˆå‚æ•°ï¼`;
                    document.getElementById('strategy-result').textContent=result;
                    return;
                }
                result = `ã€æ¬§æ˜“${coin}çªç ´å‚æ•° - è¶‹åŠ¿è¡Œæƒ…ç”¨ã€‘
1. çªç ´ç¡®è®¤ï¼šä»·æ ¼${signal.type === 'strong-long' ? 'ä¸Šæ¶¨' : 'ä¸‹è·Œ'}åˆ°${price.toFixed(2)}åï¼Œå›è½åˆ°${confirmPrice}å†ä¸‹å•
2. æ–¹å‘ï¼š${signal.text}
3. æ­¢ç›ˆä»·ï¼š${tpPrice} USDT | æ­¢æŸä»·ï¼š${slPrice} USDT
4. ä¸‹å•é‡‘é¢ï¼š${position} USDTï¼ˆæ€»èµ„é‡‘çš„${positionRate}%ï¼‰
5. å°ç™½æç¤ºï¼šæ²¡çªç ´å‰åƒä¸‡åˆ«æå‰ä¹°ï¼`;
                
                alertPriceData[coin].tp=tpPrice;
                alertPriceData[coin].sl=slPrice;
                document.getElementById(`${coin.toLowerCase()}-alert-tp`).value=tpPrice;
                document.getElementById(`${coin.toLowerCase()}-alert-sl`).value=slPrice;
            }
            document.getElementById('strategy-result').textContent=result;
        }

        // ä¿è¯é‡‘é¢„è­¦ï¼ˆä¿æŒä¸å˜ï¼‰
        function checkMargin() {
            const rate=parseFloat(document.getElementById('margin-rate').value) || 0;
            const alert=document.getElementById('margin-alert');
            if (rate < 50) {
                alert.textContent = "âœ… å®‰å…¨ï¼å¯ä»¥æ­£å¸¸æ“ä½œ";
                alert.style.color = "#27ae60";
            } else if (rate < 70) {
                alert.textContent = "âš ï¸ ä»“ä½åé‡ï¼èµ¶ç´§å‡ä»“20%";
                alert.style.color = "#f39c12";
            } else {
                alert.textContent = "âŒ å±é™©ï¼é©¬ä¸Šçˆ†ä»“ï¼ç«‹å³å‡ä»“ï¼";
                alert.style.color = "#e74c3c";
                alert('ã€å°ç™½è­¦å‘Šã€‘ä¿è¯é‡‘ä½¿ç”¨ç‡è¶…è¿‡70%ï¼Œå†ä¸å¹³ä»“å°±è¦çˆ†ä»“äº†ï¼');
            }
        }

        // æœ€å¤§äºæŸè®¡ç®—ï¼ˆä¿æŒä¸å˜ï¼‰
        function calcMaxLoss() {
            const capital=parseFloat(document.getElementById('risk-capital').value) || 1000;
            const maxLossRate=2; // æœ€å¤§å¯äº2%
            const maxLoss=(capital*maxLossRate/100).toFixed(2);
            document.getElementById('risk-result').textContent = `ã€å°ç™½æœ€å¤§å¯äºé‡‘é¢ã€‘
1. ä½ çš„æ€»èµ„é‡‘ï¼š${capital} USDT
2. å•æ¬¡æœ€å¤§èƒ½äºï¼š${maxLoss} USDTï¼ˆè¶…è¿‡è¿™ä¸ªæ•°å°±æ­¢æŸï¼ï¼‰
3. æ­¢æŸåŸåˆ™ï¼šäºåˆ°${maxLoss} USDTï¼Œç«‹å³å¹³ä»“ï¼Œåˆ«çŠ¹è±«ï¼`;
        }

        // äº¤æ˜“æ—¥å¿—æ·»åŠ ï¼ˆä¿æŒä¸å˜ï¼‰
        function addTradeLog() {
            const content=document.getElementById('log-content').value.trim();
            if (!content) return;
            const time=new Date().toLocaleString();
            const log=document.getElementById('trade-log');
            log.textContent=log.textContent === 'æš‚æ— äº¤æ˜“è®°å½•ï¼Œèµšé’±ä»è®°å½•å¼€å§‹ï¼' 
                ? `[${time}] ${content}` 
                : `${log.textContent}\n[${time}] ${content}`;
            document.getElementById('log-content').value = '';
        }

        // è‡ªå®šä¹‰å¸ç§æ·»åŠ ï¼ˆä¿æŒä¸å˜ï¼Œæ–°å¢æ¥å£IDè‡ªåŠ¨æ˜ å°„ï¼‰
        function addCustomCoin() {
            const code=document.getElementById('new-coin-code').value.trim().toUpperCase();
            const exchange=document.getElementById('new-coin-exchange').value;
            if (!code) {
                alert('è¯·è¾“å…¥å¸ç§ä»£ç ï¼Œæ¯”å¦‚APTã€ARBï¼');
                return;
            }
            if (document.querySelector(`.coin-card[data-coin="${code}"]`)) {
                alert(`${code}-USDTå·²ç»åœ¨åˆ—è¡¨é‡Œäº†ï¼`);
                return;
            }
            addCustomCoinFromRank(code);
        }

        // ========== æ–°å¢ï¼šKuCoin/Gate.io/CoinMarketCap è¡Œæƒ…æ‹‰å–å‡½æ•°ï¼ˆä¿æŒä¸å˜ï¼‰ ==========
        async function fetchCgPrice(coinCode, cgId) {
            try {
                const res=await fetch(`https://api.coingecko.com/api/v3/simple/price?ids=${cgId}&vs_currencies=usd&include_24hr_change=true`);
                const data=await res.json();
                if (data[cgId]) {
                    priceCache.cg[coinCode] = {
                        price: data[cgId].usd.toFixed(2),
                        change: data[cgId].usd_24h_change.toFixed(2)
                    };
                    apiStatus.cg=true;
                    document.querySelector(`#${coinCode.toLowerCase()}-cg-price`).textContent=priceCache.cg[coinCode].price;
                }
            } catch (e) {
                apiStatus.cg=false;
            }
        }

        async function fetchBinancePrice(coinCode, binanceId) {
            try {
                const res=await fetch(`https://api.binance.com/api/v3/ticker/24hr?symbol=${binanceId}`);
                const data=await res.json();
                if (data.lastPrice) {
                    priceCache.binance[coinCode] = {
                        price: parseFloat(data.lastPrice).toFixed(2),
                        change: parseFloat(data.priceChangePercent).toFixed(2)
                    };
                    apiStatus.binance=true;
                    document.querySelector(`#${coinCode.toLowerCase()}-binance-price`).textContent=priceCache.binance[coinCode].price;
                }
            } catch (e) {
                apiStatus.binance=false;
            }
        }

        async function fetchKuCoinPrice(coinCode, kucoinId) {
            try {
                const res=await fetch(`https://api.kucoin.com/api/v1/market/orderbook/level1?symbol=${kucoinId}`);
                const data=await res.json();
                if (data.data && data.data.price) {
                    const tickerRes=await fetch(`https://api.kucoin.com/api/v1/market/stats?symbol=${kucoinId}`);
                    const tickerData=await tickerRes.json();
                    const change=tickerData.data.changeRate*100;
                    priceCache.kucoin[coinCode] = {
                        price: parseFloat(data.data.price).toFixed(2),
                        change: change.toFixed(2)
                    };
                    apiStatus.kucoin=true;
                    document.querySelector(`#${coinCode.toLowerCase()}-kucoin-price`).textContent=priceCache.kucoin[coinCode].price;
                }
            } catch (e) {
                apiStatus.kucoin=false;
            }
        }

        async function fetchGatePrice(coinCode, gateId) {
            try {
                const res=await fetch(`https://data.gateapi.io/api2/1/ticker/${gateId}`);
                const data=await res.json();
                if (data.last) {
                    priceCache.gate[coinCode] = {
                        price: parseFloat(data.last).toFixed(2),
                        change: parseFloat(data.percentChange).toFixed(2)
                    };
                    apiStatus.gate=true;
                    document.querySelector(`#${coinCode.toLowerCase()}-gate-price`).textContent=priceCache.gate[coinCode].price;
                }
            } catch (e) {
                apiStatus.gate=false;
            }
        }

        async function fetchCmcPrice(coinCode, cmcId) {
            try {
                const res=await fetch(`https://api.coinmarketcap.com/data-api/v3/cryptocurrency/detail?id=${cmcId}`);
                const data=await res.json();
                if (data.data && data.data.price) {
                    const price=data.data.price;
                    const change=data.data.priceChange.percent;
                    priceCache.cmc[coinCode] = {
                        price: price.toFixed(2),
                        change: change.toFixed(2)
                    };
                    apiStatus.cmc=true;
                    document.querySelector(`#${coinCode.toLowerCase()}-cmc-price`).textContent=priceCache.cmc[coinCode].price;
                }
            } catch (e) {
                apiStatus.cmc=false;
            }
        }

        // ========== å‡çº§ï¼šäº”æ¥å£æ•°æ®èåˆä¸åˆ‡æ¢ç®—æ³•ï¼ˆæ›´ç¨³æ›´å‡†ï¼Œä¿æŒä¸å˜ï¼‰ ==========
        function mergePriceData(coinCode) {
            let finalPrice=0;
            let finalChange=0;
            let validPrices = [];
            let validChanges = [];

            if (apiStatus.cg && priceCache.cg[coinCode]) {
                validPrices.push(parseFloat(priceCache.cg[coinCode].price));
                validChanges.push(parseFloat(priceCache.cg[coinCode].change));
            }
            if (apiStatus.binance && priceCache.binance[coinCode]) {
                validPrices.push(parseFloat(priceCache.binance[coinCode].price));
                validChanges.push(parseFloat(priceCache.binance[coinCode].change));
            }
            if (apiStatus.kucoin && priceCache.kucoin[coinCode]) {
                validPrices.push(parseFloat(priceCache.kucoin[coinCode].price));
                validChanges.push(parseFloat(priceCache.kucoin[coinCode].change));
            }
            if (apiStatus.gate && priceCache.gate[coinCode]) {
                validPrices.push(parseFloat(priceCache.gate[coinCode].price));
                validChanges.push(parseFloat(priceCache.gate[coinCode].change));
            }
            if (apiStatus.cmc && priceCache.cmc[coinCode]) {
                validPrices.push(parseFloat(priceCache.cmc[coinCode].price));
                validChanges.push(parseFloat(priceCache.cmc[coinCode].change));
            }

            if (validPrices.length > 0) {
                finalPrice=(validPrices.reduce((a, b) => a+b, 0)/validPrices.length).toFixed(2);
                finalChange=(validChanges.reduce((a, b) => a+b, 0)/validChanges.length).toFixed(2);
                activeApi = `${validPrices.length}ä¸ªæ¥å£å‡ä»·`;
            } else {
                finalPrice = "--";
                finalChange = "--";
                activeApi = "æ— ";
            }

            const card=document.querySelector(`.coin-card[data-coin="${coinCode}"]`);
            if (finalPrice !== "--") {
                card.querySelector('.real-price').textContent=finalPrice;
                card.querySelector('.real-change').textContent=finalChange;
                card.querySelector('.price-change').className = `price-change ${parseFloat(finalChange) >= 0 ? 'rise' : 'fall'}`;
                const signal=getSignal(parseFloat(finalChange));
                card.className = `coin-card ${signal.type}`;
                card.querySelector('.okx-order-params span').textContent=signal.text;
                checkAlert(coinCode, parseFloat(finalPrice));
            }
        }

        // æ£€æŸ¥æ¥å£çŠ¶æ€å¹¶æ›´æ–°æ˜¾ç¤º â†’ æ–°å¢KuCoin/Gate.io/CoinMarketCapï¼ˆä¿æŒä¸å˜ï¼‰
        function updateApiStatus() {
            document.querySelectorAll('#api-status span')[0].textContent = `CoinGeckoï¼š${apiStatus.cg ? 'âœ… åœ¨çº¿' : 'âŒ ç¦»çº¿'}`;
            document.querySelectorAll('#api-status span')[0].className=apiStatus.cg ? 'api-online' : 'api-offline';
            document.querySelectorAll('#api-status span')[1].textContent = `Binanceï¼š${apiStatus.binance ? 'âœ… åœ¨çº¿' : 'âŒ ç¦»çº¿'}`;
            document.querySelectorAll('#api-status span')[1].className=apiStatus.binance ? 'api-online' : 'api-offline';
            document.querySelectorAll('#api-status span')[2].textContent = `KuCoinï¼š${apiStatus.kucoin ? 'âœ… åœ¨çº¿' : 'âŒ ç¦»çº¿'}`;
            document.querySelectorAll('#api-status span')[2].className=apiStatus.kucoin ? 'api-online' : 'api-offline';
            document.querySelectorAll('#api-status span')[3].textContent = `Gate.ioï¼š${apiStatus.gate ? 'âœ… åœ¨çº¿' : 'âŒ ç¦»çº¿'}`;
            document.querySelectorAll('#api-status span')[3].className=apiStatus.gate ? 'api-online' : 'api-offline';
            document.querySelectorAll('#api-status span')[4].textContent = `CoinMarketCapï¼š${apiStatus.cmc ? 'âœ… åœ¨çº¿' : 'âŒ ç¦»çº¿'}`;
            document.querySelectorAll('#api-status span')[4].className=apiStatus.cmc ? 'api-online' : 'api-offline';
            document.getElementById('active-api').textContent=activeApi;
        }

        // ä»·æ ¼æé†’ç›‘æ§ï¼ˆä¿æŒä¸å˜ï¼‰
        function checkAlert(coinCode, currentPrice) {
            if (!alertSwitchStatus[coinCode]) return;
            if (alertPriceData[coinCode].tp === 0 || alertPriceData[coinCode].sl === 0) return;

            const tp=parseFloat(alertPriceData[coinCode].tp);
            const sl=parseFloat(alertPriceData[coinCode].sl);
            const changeRate=parseFloat(document.querySelector(`.coin-card[data-coin="${coinCode}"] .real-change`).textContent) || 0;
            const signal=getSignal(changeRate);

            if (signal.type === 'strong-long') {
                if (currentPrice >= tp) {
                    triggerAlert(coinCode, "æ­¢ç›ˆ", tp, currentPrice);
                    closeAlert(coinCode);
                }
                if (currentPrice <= sl) {
                    triggerAlert(coinCode, "æ­¢æŸ", sl, currentPrice);
                    closeAlert(coinCode);
                }
            } else if (signal.type === 'strong-short') {
                if (currentPrice <= tp) {
                    triggerAlert(coinCode, "æ­¢ç›ˆ", tp, currentPrice);
                    closeAlert(coinCode);
                }
                if (currentPrice >= sl) {
                    triggerAlert(coinCode, "æ­¢æŸ", sl, currentPrice);
                    closeAlert(coinCode);
                }
            }
        }

        function triggerAlert(coinCode, type, targetPrice, currentPrice) {
            const time=new Date().toLocaleString();
            const alertMsg = `ã€${time}ã€‘${coinCode}è§¦å‘${type}æé†’ï¼ç›®æ ‡ä»·ï¼š${targetPrice} USDTï¼Œå½“å‰ä»·ï¼š${currentPrice} USDT`;
            alert(alertMsg);
            const audio=new Audio('https://assets.mixkit.co/sfx...