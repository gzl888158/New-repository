<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>豆包搭档·多平台合约交易辅助工具</title>
    <style>
        /* 欧易同源深色主题 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Microsoft YaHei", sans-serif;
        }
        body {
            background-color: #121212;
            color: #ffffff;
            padding: 20px;
        }
        .header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #333333;
        }
        .header h1 {
            color: #27ae60;
            font-size: 24px;
        }
        .shortcut-tips {
            margin-top: 10px;
            font-size: 12px;
            color: #999999;
        }
        /* 分屏布局容器 */
        .monitor-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        .coin-card {
            background-color: #1e1e1e;
            border-radius: 8px;
            padding: 15px;
            border: 1px solid #333333;
        }
        .coin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .coin-name {
            font-weight: bold;
            color: #27ae60;
        }
        .exchange-select {
            background-color: #2c2c2c;
            color: #ffffff;
            border: 1px solid #444444;
            border-radius: 4px;
            padding: 3px 8px;
            font-size: 12px;
        }
        .coin-price {
            font-size: 18px;
            margin: 10px 0;
        }
        .price-change {
            font-size: 14px;
        }
        .rise {
            color: #e74c3c;
        }
        .fall {
            color: #27ae60;
        }
        /* K线与指标区 */
        .kline-area {
            height: 150px;
            background-color: #2c2c2c;
            border-radius: 4px;
            margin: 10px 0;
            position: relative;
            overflow: hidden;
        }
        .kline-placeholder {
            text-align: center;
            line-height: 150px;
            color: #999999;
            font-size: 12px;
        }
        .indicator-btn {
            background-color: #27ae60;
            color: #ffffff;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            margin-top: 5px;
        }
        /* 策略与风险区 */
        .strategy-risk-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        .strategy-card, .risk-card {
            background-color: #1e1e1e;
            border-radius: 8px;
            padding: 20px;
            border: 1px solid #333333;
        }
        .card-title {
            color: #27ae60;
            margin-bottom: 15px;
            font-size: 18px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .form-group {
            margin-bottom: 12px;
        }
        .form-group label {
            display: block;
            font-size: 14px;
            margin-bottom: 5px;
            color: #cccccc;
        }
        .form-group input, .form-group select {
            width: 100%;
            padding: 8px;
            background-color: #2c2c2c;
            color: #ffffff;
            border: 1px solid #444444;
            border-radius: 4px;
        }
        .calc-btn {
            background-color: #27ae60;
            color: #ffffff;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
        }
        .result-area {
            margin-top: 15px;
            padding: 10px;
            background-color: #2c2c2c;
            border-radius: 4px;
            font-size: 14px;
            white-space: pre-wrap;
        }
        /* AI解读与交易日志 */
        .ai-log-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .ai-card, .log-card {
            background-color: #1e1e1e;
            border-radius: 8px;
            padding: 20px;
            border: 1px solid #333333;
        }
        .ai-content {
            margin-top: 15px;
            padding: 10px;
            background-color: #2c2c2c;
            border-radius: 4px;
            min-height: 100px;
            font-size: 14px;
        }
        .log-content {
            margin-top: 15px;
            padding: 10px;
            background-color: #2c2c2c;
            border-radius: 4px;
            min-height: 100px;
            font-size: 12px;
            white-space: pre-wrap;
        }
        .add-log-btn {
            background-color: #27ae60;
            color: #ffffff;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
        }
        /* 预警线样式 */
        .alert-line {
            position: absolute;
            width: 100%;
            height: 1px;
            z-index: 10;
        }
        .profit-line {
            background-color: #27ae60;
        }
        .stop-line {
            background-color: #e74c3c;
        }
        .warn-line {
            background-color: #f39c12;
        }
        .line-label {
            position: absolute;
            font-size: 10px;
            color: inherit;
        }
        /* 响应式适配 */
        @media (max-width: 1200px) {
            .monitor-container {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        @media (max-width: 768px) {
            .monitor-container, .strategy-risk-container, .ai-log-container {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- 头部标题与快捷键提示 -->
    <div class="header">
        <h1>豆包搭档·多平台合约交易辅助工具</h1>
        <div class="shortcut-tips">
            快捷键：F1=切换K线周期 | F2=清空预警 | F3=打开亏损计算器 | F4=叠加/隐藏指标
        </div>
    </div>

    <!-- 多币种分屏监控区 -->
    <div class="monitor-container">
        <!-- BTC-USDT -->
        <div class="coin-card">
            <div class="coin-header">
                <span class="coin-name">BTC-USDT</span>
                <select class="exchange-select">
                    <option>欧易</option>
                    <option>币安</option>
                    <option>火币</option>
                </select>
            </div>
            <div class="coin-price">价格：<span id="btc-price">--</span> USDT</div>
            <div class="price-change fall">24h涨跌幅：<span id="btc-change">--</span></div>
            <div class="kline-area" id="btc-kline">
                <div class="kline-placeholder">15m裸K · 双底形态标注</div>
            </div>
            <button class="indicator-btn" onclick="toggleIndicator('btc-kline')">F4 叠加指标</button>
        </div>

        <!-- ETH-USDT -->
        <div class="coin-card">
            <div class="coin-header">
                <span class="coin-name">ETH-USDT</span>
                <select class="exchange-select">
                    <option>欧易</option>
                    <option>币安</option>
                    <option>火币</option>
                </select>
            </div>
            <div class="coin-price">价格：<span id="eth-price">--</span> USDT</div>
            <div class="price-change rise">24h涨跌幅：<span id="eth-change">--</span></div>
            <div class="kline-area" id="eth-kline">
                <div class="kline-placeholder">15m裸K · 三角收敛形态</div>
            </div>
            <button class="indicator-btn" onclick="toggleIndicator('eth-kline')">F4 叠加指标</button>
        </div>

        <!-- SOL-USDT 自定义币种1 -->
        <div class="coin-card">
            <div class="coin-header">
                <span class="coin-name">SOL-USDT</span>
                <select class="exchange-select">
                    <option>欧易</option>
                    <option>币安</option>
                    <option>火币</option>
                </select>
            </div>
            <div class="coin-price">价格：<span id="sol-price">--</span> USDT</div>
            <div class="price-change fall">24h涨跌幅：<span id="sol-change">--</span></div>
            <div class="kline-area" id="sol-kline">
                <div class="kline-placeholder">15m裸K · 等待突破</div>
            </div>
            <button class="indicator-btn" onclick="toggleIndicator('sol-kline')">F4 叠加指标</button>
        </div>

        <!-- ADA-USDT 自定义币种2 -->
        <div class="coin-card">
            <div class="coin-header">
                <span class="coin-name">ADA-USDT</span>
                <select class="exchange-select">
                    <option>欧易</option>
                    <option>币安</option>
                    <option>火币</option>
                </select>
            </div>
            <div class="coin-price">价格：<span id="ada-price">--</span> USDT</div>
            <div class="price-change rise">24h涨跌幅：<span id="ada-change">--</span></div>
            <div class="kline-area" id="ada-kline">
                <div class="kline-placeholder">15m裸K · 头肩顶形态</div>
            </div>
            <button class="indicator-btn" onclick="toggleIndicator('ada-kline')">F4 叠加指标</button>
        </div>
    </div>

    <!-- 策略与风险控制区 -->
    <div class="strategy-risk-container">
        <!-- 策略计算器 -->
        <div class="strategy-card">
            <div class="card-title">
                <span>核心策略计算器</span>
                <span style="font-size:12px;color:#999">支持止盈止损/网格/突破</span>
            </div>
            <div class="form-group">
                <label>选择策略类型</label>
                <select id="strategy-type">
                    <option value="tp-sl">止盈止损策略</option>
                    <option value="grid">网格交易策略</option>
                    <option value="break">突破交易策略</option>
                </select>
            </div>
            <div class="form-group">
                <label>开仓价（USDT）</label>
                <input type="number" id="open-price" placeholder="如 46000">
            </div>
            <div class="form-group">
                <label>总资金（USDT）</label>
                <input type="number" id="total-capital" placeholder="如 1000">
            </div>
            <div class="form-group" id="tp-sl-group">
                <label>止盈涨幅/止损跌幅（%）</label>
                <input type="text" id="tp-sl-rate" placeholder="止盈5/止损2">
            </div>
            <div class="form-group" id="grid-group" style="display:none">
                <label>网格数量/价格区间（%）</label>
                <input type="text" id="grid-param" placeholder="10格/±5%">
            </div>
            <div class="form-group" id="break-group" style="display:none">
                <label>突破确认回踩（%）</label>
                <input type="number" id="break-rate" placeholder="0.5" value="0.5">
            </div>
            <button class="calc-btn" onclick="calcStrategy()">生成操作建议</button>
            <div class="result-area" id="strategy-result">请输入参数后点击计算</div>
        </div>

        <!-- 风险控制区 -->
        <div class="risk-card">
            <div class="card-title">
                <span>风险控制中心</span>
                <span style="font-size:12px;color:#999">F3 打开亏损计算器</span>
            </div>
            <div class="form-group">
                <label>保证金使用率（%）</label>
                <input type="number" id="margin-rate" placeholder="如 50" oninput="checkMargin()">
                <div id="margin-alert" style="margin-top:5px;font-size:12px;color:#f39c12"></div>
            </div>
            <div class="form-group">
                <label>总资金（USDT）</label>
                <input type="number" id="risk-capital" placeholder="如 1000">
            </div>
            <div class="form-group">
                <label>风险容忍度（%）</label>
                <input type="number" id="risk-rate" placeholder="2" value="2">
            </div>
            <button class="calc-btn" onclick="calcMaxLoss()">F3 计算最大亏损</button>
            <div class="result-area" id="risk-result">请输入参数后点击计算</div>
            <div class="form-group" style="margin-top:10px">
                <label>全网多空比</label>
                <input type="text" id="long-short-ratio" placeholder="3:2" value="2:1">
                <button class="calc-btn" style="padding:5px" onclick="analysisRatio()">解读</button>
            </div>
        </div>
    </div>

    <!-- AI解读与交易日志 -->
    <div class="ai-log-container">
        <!-- AI行情解读 -->
        <div class="ai-card">
            <div class="card-title">
                <span>AI行情解读（每30分钟更新）</span>
                <span style="font-size:12px;color:#999">专业内核+傻瓜式表达</span>
            </div>
            <div class="ai-content" id="ai-analysis">
                【BTC】当前价格-- USDT，15m K线双底形态，MACD金叉，多空比2:1。
                建议：轻仓开多，止盈-- USDT，止损-- USDT；跌破止损立即平仓。
                <br><br>
                【ETH】当前价格-- USDT，15m K线三角收敛，RSI中性，多空比1.5:1。
                建议：等待突破，突破后回踩≤0.5%开多，止损-- USDT。
            </div>
        </div>

        <!-- 交易日志 -->
        <div class="log-card">
            <div class="card-title">
                <span>交易成长日志</span>
                <span style="font-size:12px;color:#999">记录操作与盈亏</span>
            </div>
            <div class="form-group">
                <label>操作记录（币种+方向+盈亏）</label>
                <input type="text" id="log-content" placeholder="如 BTC开多 盈利3%">
            </div>
            <button class="add-log-btn" onclick="addTradeLog()">添加记录</button>
            <div class="log-content" id="trade-log">暂无交易记录</div>
        </div>
    </div>

    <script>
        // 切换策略显示组
        document.getElementById('strategy-type').addEventListener('change', function() {
            const type = this.value;
            document.getElementById('tp-sl-group').style.display = type === 'tp-sl' ? 'block' : 'none';
            document.getElementById('grid-group').style.display = type === 'grid' ? 'block' : 'none';
            document.getElementById('break-group').style.display = type === 'break' ? 'block' : 'none';
        });

        // 切换指标显示
        function toggleIndicator(id) {
            const kline = document.getElementById(id);
            const placeholder = kline.querySelector('.kline-placeholder');
            if (placeholder.textContent.includes('裸K')) {
                placeholder.textContent = 'MACD+RSI+BOLL 指标已叠加';
            } else {
                placeholder.textContent = '15m裸K · 关键形态标注';
            }
        }

        // 策略计算
        function calcStrategy() {
            const type = document.getElementById('strategy-type').value;
            const openPrice = parseFloat(document.getElementById('open-price').value) || 0;
            const totalCapital = parseFloat(document.getElementById('total-capital').value) || 0;
            let result = '';

            if (openPrice <= 0 || totalCapital <= 0) {
                result = '请输入有效的开仓价和总资金！';
                document.getElementById('strategy-result').textContent = result;
                return;
            }

            if (type === 'tp-sl') {
                const rate = document.getElementById('tp-sl-rate').value.split('/');
                const tpRate = parseFloat(rate[0]) || 0;
                const slRate = parseFloat(rate[1]) || 0;
                if (tpRate <= 0 || slRate <= 0) {
                    result = '请输入有效的止盈止损比例（如 5/2）！';
                    document.getElementById('strategy-result').textContent = result;
                    return;
                }
                const tpPrice = openPrice * (1 + tpRate / 100);
                const slPrice = openPrice * (1 - slRate / 100);
                const suggest = `【止盈止损策略操作建议】
1. 止盈价：${tpPrice.toFixed(2)} USDT  止损价：${slPrice.toFixed(2)} USDT
2. 建议仓位：${(totalCapital * 0.05).toFixed(2)} USDT（总资金5%）
3. 操作步骤：打开欧易/币安/火币 → 对应币种合约 → 限价开仓 → 设置止盈止损
4. 动态止盈：盈利3%后，止损位上移至开仓价，避免盈利回吐`;
                result = suggest;
            } else if (type === 'grid') {
                const param = document.getElementById('grid-param').value.split('/');
                const gridNum = parseInt(param[0]) || 10;
                const range = parseFloat(param[1].replace('±', '').replace('%', '')) || 5;
                const gridStep = (openPrice * range / 100) / gridNum;
                const startPrice = openPrice * (1 - range / 100);
                const endPrice = openPrice * (1 + range / 100);
                const perGridCapital = (totalCapital / gridNum).toFixed(2);
                const suggest = `【网格交易策略操作建议】
1. 网格参数：${gridNum}格  价格区间：${startPrice.toFixed(2)} - ${endPrice.toFixed(2)} USDT
2. 每格仓位：${perGridCapital} USDT  每格价差：${gridStep.toFixed(2)} USDT
3. 操作步骤：下跌${gridStep.toFixed(2)} USDT补仓1格，上涨${gridStep.toFixed(2)} USDT止盈1格
4. 风险提示：震荡行情适用，趋势行情禁用；默认不开启马丁格尔（高风险）`;
                result = suggest;
            } else if (type === 'break') {
                const breakRate = parseFloat(document.getElementById('break-rate').value) || 0.5;
                const confirmPrice = openPrice * (1 - breakRate / 100);
                const slPrice = confirmPrice * (1 - 0.5 / 100);
                const suggest = `【突破交易策略操作建议】
1. 突破确认：价格突破${openPrice.toFixed(2)} USDT后，回踩≤${breakRate}%（即≥${confirmPrice.toFixed(2)} USDT）确认有效
2. 止损价：${slPrice.toFixed(2)} USDT（突破失败离场）
3. 建议仓位：${(totalCapital * 0.03).toFixed(2)} USDT（总资金3%）
4. 多平台适配：欧易/币安/火币操作一致，突破后立即开仓，避免踏空`;
                result = suggest;
            }
            document.getElementById('strategy-result').textContent = result;
        }

        // 保证金预警
        function checkMargin() {
            const rate = parseFloat(document.getElementById('margin-rate').value) || 0;
            const alert = document.getElementById('margin-alert');
            if (rate < 50) {
                alert.textContent = '保证金使用率安全，可正常操作';
                alert.style.color = '#27ae60';
            } else if (rate < 70) {
                alert.textContent = '黄色预警：仓位偏重，建议减仓10%-20%';
                alert.style.color = '#f39c12';
            } else if (rate < 80) {
                alert.textContent = '红色预警：保证金不足，即将触发强平，立即减仓或追加资金';
                alert.style.color = '#e74c3c';
            } else {
                alert.textContent = '强制预警：禁止开新仓，立即减仓！';
                alert.style.color = '#e74c3c';
            }
        }

        // 最大亏损计算
        function calcMaxLoss() {
            const capital = parseFloat(document.getElementById('risk-capital').value) || 0;
            const rate = parseFloat(document.getElementById('risk-rate').value) || 2;
            if (capital <= 0) {
                document.getElementById('risk-result').textContent = '请输入有效的总资金！';
                return;
            }
            const maxLoss = (capital * rate / 100).toFixed(2);
            const suggest = `【最大亏损计算结果】
1. 总资金：${capital} USDT  风险容忍度：${rate}%
2. 单笔最大可亏损：${maxLoss} USDT
3. 建议单笔仓位：不超过总资金的5%（${(capital * 0.05).toFixed(2)} USDT）
4. 专业建议：保证金使用率不超过70%，避免爆仓风险`;
            document.getElementById('risk-result').textContent = suggest;
        }

        // 多空比解读
        function analysisRatio() {
            const ratio = document.getElementById('long-short-ratio').value;
            const [long, short] = ratio.split(':').map(Number);
            let suggest = '';
            if (long > short) {
                suggest = `【多空比解读：${ratio}】市场多头占优，你的多单方向与主流一致，可继续持有；若持仓为空单，建议减仓规避逆势风险。`;
            } else if (short > long) {
                suggest = `【多空比解读：${ratio}】市场空头占优，你的空单方向与主流一致，可继续持有；若持仓为多单，建议减仓规避逆势风险。`;
            } else {
                suggest = `【多空比解读：${ratio}】市场多空平衡，建议观望或轻仓试错，等待明确方向。`;
            }
            document.getElementById('risk-result').textContent = suggest;
        }

        // 添加交易日志
        function addTradeLog() {
            const content = document.getElementById('log-content').value.trim();
            if (!content) return;
            const time = new Date().toLocaleString();
            const log = document.getElementById('trade-log');
            const newLog = log.textContent === '暂无交易记录' ? '' : log.textContent + '\n';
            log.textContent = newLog + `[${time}] ${content}`;
            document.getElementById('log-content').value = '';
        }

        // 快捷键监听
        document.addEventListener('keydown', function(e) {
            switch(e.key) {
                case 'F1':
                    alert('已切换K线周期：15m → 5m → 1m → 1h 循环切换');
                    break;
                case 'F2':
                    if (confirm('是否清空所有价格预警线？')) {
                        document.querySelectorAll('.alert-line').forEach(line => line.remove());
                        alert('预警线已清空');
                    }
                    break;
                case 'F3':
                    document.getElementById('risk-capital').focus();
                    break;
                case 'F4':
                    toggleIndicator('btc-kline');
                    toggleIndicator('eth-kline');
                    toggleIndicator('sol-kline');
                    toggleIndicator('ada-kline');
                    break;
            }
        });

        // 模拟行情数据更新（实际对接公开API后可替换）
        setInterval(() => {
            const btcPrice = (Math.random() * 2000 + 45000).toFixed(2);
            const ethPrice = (Math.random() * 100 + 2200).toFixed(2);
            const solPrice = (Math.random() * 5 + 100).toFixed(2);
            const adaPrice = (Math.random() * 0.1 + 0.5).toFixed(3);
            document.getElementById('btc-price').textContent = btcPrice;
            document.getElementById('eth-price').textContent = ethPrice;
            document.getElementById('sol-price').textContent = solPrice;
            document.getElementById('ada-price').textContent = adaPrice;

            const btcChange = (Math.random() * 2 - 1).toFixed(2);
            const ethChange = (Math.random() * 2 - 0.5).toFixed(2);
            document.getElementById('btc-change').textContent = btcChange + '%';
            document.getElementById('eth-change').textContent = ethChange + '%';
            document.getElementById('sol-change').textContent = (Math.random() * 3 - 1).toFixed(2) + '%';
            document.getElementById('ada-change').textContent = (Math.random() * 3 - 0.5).toFixed(2) + '%';

            // 更新AI解读
            const aiText = `【BTC】当前价格${btcPrice} USDT，15m K线双底形态，MACD金叉，多空比2:1。
建议：轻仓开多，止盈${(parseFloat(btcPrice) * 1.05).toFixed(2)} USDT，止损${(parseFloat(btcPrice) * 0.98).toFixed(2)} USDT；跌破止损立即平仓。

【ETH】当前价格${ethPrice} USDT，15m K线三角收敛，RSI中性，多空比1.5:1。
建议：等待突破，突破后回踩≤0.5%开多，止损${(parseFloat(ethPrice) * 0.995).toFixed(2)} USDT。`;
            document.getElementById('ai-analysis').textContent = aiText;
        }, 30000);
    </script>
</body>
</html>